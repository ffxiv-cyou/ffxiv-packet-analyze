(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var e=Array.isArray,t=Array.prototype.indexOf,n=Array.from;Object.keys;var r=Object.defineProperty,i=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyDescriptors,o=Object.prototype,s=Array.prototype,c=Object.getPrototypeOf,l=Object.isExtensible;const u=()=>{};function d(e){for(var t=0;t<e.length;t++)e[t]()}function f(){var e,t;return{promise:new Promise((n,r)=>{e=n,t=r}),resolve:e,reject:t}}const p=1024,m=2048,h=4096,g=8192,_=65536,v=1<<19,y=32768,b=1<<21,x=1<<23,S=Symbol(`$state`),C=Symbol(`legacy props`),ee=Symbol(``),w=new class extends Error{name=`StaleReactionError`;message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function te(e){throw Error(`https://svelte.dev/e/lifecycle_outside_component`)}function T(){throw Error(`https://svelte.dev/e/async_derived_orphan`)}function E(e){throw Error(`https://svelte.dev/e/effect_in_teardown`)}function ne(){throw Error(`https://svelte.dev/e/effect_in_unowned_derived`)}function re(e){throw Error(`https://svelte.dev/e/effect_orphan`)}function ie(){throw Error(`https://svelte.dev/e/effect_update_depth_exceeded`)}function ae(e){throw Error(`https://svelte.dev/e/props_invalid_value`)}function oe(){throw Error(`https://svelte.dev/e/state_descriptors_fixed`)}function se(){throw Error(`https://svelte.dev/e/state_prototype_fixed`)}function ce(){throw Error(`https://svelte.dev/e/state_unsafe_mutation`)}function le(){throw Error(`https://svelte.dev/e/svelte_boundary_reset_onerror`)}const D={},O=Symbol();function ue(e){console.warn(`https://svelte.dev/e/hydration_mismatch`)}function de(){console.warn(`https://svelte.dev/e/select_multiple_invalid_value`)}function fe(){console.warn(`https://svelte.dev/e/svelte_boundary_reset_noop`)}let k=!1;function pe(e){k=e}let A;function j(e){if(e===null)throw ue(),D;return A=e}function me(){return j(Et(A))}function M(e){if(k){if(Et(A)!==null)throw ue(),D;A=e}}function he(e=1){if(k){for(var t=e,n=A;t--;)n=Et(n);A=n}}function ge(e=!0){for(var t=0,n=A;;){if(n.nodeType===8){var r=n.data;if(r===`]`){if(t===0)return n;--t}else (r===`[`||r===`[!`)&&(t+=1)}var i=Et(n);e&&n.remove(),n=i}}function _e(e){if(!e||e.nodeType!==8)throw ue(),D;return e.data}function ve(e){return e===this.v}function ye(e,t){return e==e?e!==t||typeof e==`object`&&!!e||typeof e==`function`:t==t}function be(e){return!ye(e,this.v)}let xe=null;function Se(e){xe=e}function Ce(e,t=!1,n){xe={p:xe,c:null,e:null,s:e,x:null,l:null}}function we(e){var t=xe,n=t.e;if(n!==null){t.e=null;for(var r of n)Vt(r)}return e!==void 0&&(t.x=e),xe=t.p,e??{}}function Te(){return!0}var Ee=[];function De(){var e=Ee;Ee=[],d(e)}function Oe(e){if(Ee.length===0&&!Ve){var t=Ee;queueMicrotask(()=>{t===Ee&&De()})}Ee.push(e)}function ke(){for(;Ee.length>0;)De()}var Ae=new WeakMap;function je(e){var t=G;if(t===null)return U.f|=x,e;if(t.f&32768)Me(e,t);else{if(!(t.f&128))throw!t.parent&&e instanceof Error&&Ne(e),e;t.b.error(e)}}function Me(e,t){for(;t!==null;){if(t.f&128)try{t.b.error(e);return}catch(t){e=t}t=t.parent}throw e instanceof Error&&Ne(e),e}function Ne(e){let t=Ae.get(e);t&&(r(e,`message`,{value:t.message}),r(e,`stack`,{value:t.stack}))}var Pe=new Set;let N=null,Fe=null,Ie=null,Le=new Set;var Re=[],ze=null,Be=!1;let Ve=!1;var He=class e{committed=!1;current=new Map;#previous=new Map;#callbacks=new Set;#pending=0;#blocking_pending=0;#deferred=null;#dirty_effects=[];#maybe_dirty_effects=[];skipped_effects=new Set;process(e){Re=[],Fe=null,this.apply();var t={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(let n of e)this.#traverse_effect_tree(n,t);this.#resolve(),this.#blocking_pending>0?(this.#defer_effects(t.effects),this.#defer_effects(t.render_effects),this.#defer_effects(t.block_effects)):(Fe=this,N=null,qe(t.render_effects),qe(t.effects),Fe=null),Ie=null}#traverse_effect_tree(e,t){e.f^=p;for(var n=e.first;n!==null;){var r=n.f,i=(r&96)!=0,a=i&&(r&1024)!=0||(r&8192)!=0||this.skipped_effects.has(n);if(n.f&128&&n.b?.is_pending()&&(t={parent:t,effect:n,effects:[],render_effects:[],block_effects:[]}),!a&&n.fn!==null){i?n.f^=p:r&4?t.effects.push(n):Sn(n)&&(n.f&16&&t.block_effects.push(n),Dn(n));var o=n.first;if(o!==null){n=o;continue}}var s=n.parent;for(n=n.next;n===null&&s!==null;)s===t.effect&&(this.#defer_effects(t.effects),this.#defer_effects(t.render_effects),this.#defer_effects(t.block_effects),t=t.parent),n=s.next,s=s.parent}}#defer_effects(e){for(let t of e)(t.f&2048?this.#dirty_effects:this.#maybe_dirty_effects).push(t),J(t,p)}capture(e,t){this.#previous.has(e)||this.#previous.set(e,t),this.current.set(e,e.v),Ie?.set(e,e.v)}activate(){N=this}deactivate(){N=null,Ie=null}flush(){if(Re.length>0){if(this.activate(),We(),N!==null&&N!==this)return}else this.#resolve();this.deactivate();for(let e of Le)if(Le.delete(e),e(),N!==null)break}#resolve(){if(this.#blocking_pending===0){for(let e of this.#callbacks)e();this.#callbacks.clear()}this.#pending===0&&this.#commit()}#commit(){if(Pe.size>1){this.#previous.clear();var e=Ie,t=!0,n={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(let e of Pe){if(e===this){t=!1;continue}let r=[];for(let[n,i]of this.current){if(e.current.has(n))if(t&&i!==e.current.get(n))e.current.set(n,i);else continue;r.push(n)}if(r.length===0)continue;let i=[...e.current.keys()].filter(e=>!this.current.has(e));if(i.length>0){let t=new Set,a=new Map;for(let e of r)Je(e,i,t,a);if(Re.length>0){N=e,e.apply();for(let t of Re)e.#traverse_effect_tree(t,n);Re=[],e.deactivate()}}}N=null,Ie=e}this.committed=!0,Pe.delete(this),this.#deferred?.resolve()}increment(e){this.#pending+=1,e&&(this.#blocking_pending+=1)}decrement(e){--this.#pending,e&&--this.#blocking_pending;for(let e of this.#dirty_effects)J(e,m),Xe(e);for(let e of this.#maybe_dirty_effects)J(e,h),Xe(e);this.#dirty_effects=[],this.#maybe_dirty_effects=[],this.flush()}add_callback(e){this.#callbacks.add(e)}settled(){return(this.#deferred??=f()).promise}static ensure(){if(N===null){let t=N=new e;Pe.add(N),Ve||e.enqueue(()=>{N===t&&t.flush()})}return N}static enqueue(e){Oe(e)}apply(){}};function Ue(e){var t=Ve;Ve=!0;try{var n;for(e&&(N!==null&&We(),n=e());;){if(ke(),Re.length===0&&(N?.flush(),Re.length===0))return ze=null,n;We()}}finally{Ve=t}}function We(){var e=an;Be=!0;try{var t=0;for(on(!0);Re.length>0;){var n=He.ensure();t++>1e3&&Ge(),n.process(Re),dt.clear()}}finally{Be=!1,on(e),ze=null}}function Ge(){try{ie()}catch(e){Me(e,ze)}}let Ke=null;function qe(e){var t=e.length;if(t!==0){for(var n=0;n<t;){var r=e[n++];if(!(r.f&24576)&&Sn(r)&&(Ke=new Set,Dn(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?Zt(r):r.fn=null),Ke?.size>0)){dt.clear();for(let e of Ke){if(e.f&24576)continue;let t=[e],n=e.parent;for(;n!==null;)Ke.has(n)&&(Ke.delete(n),t.push(n)),n=n.parent;for(let e=t.length-1;e>=0;e--){let n=t[e];n.f&24576||Dn(n)}}Ke.clear()}}Ke=null}}function Je(e,t,n,r){if(!n.has(e)&&(n.add(e),e.reactions!==null))for(let i of e.reactions){let e=i.f;e&2?Je(i,t,n,r):e&4194320&&!(e&2048)&&Ye(i,t,r)&&(J(i,m),Xe(i))}}function Ye(e,t,n){let r=n.get(e);if(r!==void 0)return r;if(e.deps!==null)for(let r of e.deps){if(t.includes(r))return!0;if(r.f&2&&Ye(r,t,n))return n.set(r,!0),!0}return n.set(e,!1),!1}function Xe(e){for(var t=ze=e;t.parent!==null;){t=t.parent;var n=t.f;if(Be&&t===G&&n&16)return;if(n&96){if(!(n&1024))return;t.f^=p}}Re.push(t)}function Ze(e){let t=0,n=ft(0),r;return()=>{Rt()&&(q(n),Gt(()=>(t===0&&(r=An(()=>e(()=>ht(n)))),t+=1,()=>{Oe(()=>{--t,t===0&&(r?.(),r=void 0,ht(n))})})))}}var Qe=v|65664;function $e(e,t,n){new et(e,t,n)}var et=class{parent;#pending=!1;#anchor;#hydrate_open=k?A:null;#props;#children;#effect;#main_effect=null;#pending_effect=null;#failed_effect=null;#offscreen_fragment=null;#pending_anchor=null;#local_pending_count=0;#pending_count=0;#is_creating_fallback=!1;#effect_pending=null;#effect_pending_update=()=>{this.#effect_pending&&mt(this.#effect_pending,this.#local_pending_count)};#effect_pending_subscriber=Ze(()=>(this.#effect_pending=ft(this.#local_pending_count),()=>{this.#effect_pending=null}));constructor(e,t,n){this.#anchor=e,this.#props=t,this.#children=n,this.parent=G.b,this.#pending=!!this.#props.pending,this.#effect=Kt(()=>{if(G.b=this,k){let e=this.#hydrate_open;me(),e.nodeType===8&&e.data===`[!`?this.#hydrate_pending_content():this.#hydrate_resolved_content()}else{var e=this.#get_anchor();try{this.#main_effect=V(()=>n(e))}catch(e){this.error(e)}this.#pending_count>0?this.#show_pending_snippet():this.#pending=!1}return()=>{this.#pending_anchor?.remove()}},Qe),k&&(this.#anchor=A)}#hydrate_resolved_content(){try{this.#main_effect=V(()=>this.#children(this.#anchor))}catch(e){this.error(e)}this.#pending=!1}#hydrate_pending_content(){let e=this.#props.pending;e&&(this.#pending_effect=V(()=>e(this.#anchor)),He.enqueue(()=>{var e=this.#get_anchor();this.#main_effect=this.#run(()=>(He.ensure(),V(()=>this.#children(e)))),this.#pending_count>0?this.#show_pending_snippet():(Qt(this.#pending_effect,()=>{this.#pending_effect=null}),this.#pending=!1)}))}#get_anchor(){var e=this.#anchor;return this.#pending&&(this.#pending_anchor=L(),this.#anchor.before(this.#pending_anchor),e=this.#pending_anchor),e}is_pending(){return this.#pending||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#props.pending}#run(e){var t=G,n=U,r=xe;un(this.#effect),W(this.#effect),Se(this.#effect.ctx);try{return e()}catch(e){return je(e),null}finally{un(t),W(n),Se(r)}}#show_pending_snippet(){let e=this.#props.pending;this.#main_effect!==null&&(this.#offscreen_fragment=document.createDocumentFragment(),this.#offscreen_fragment.append(this.#pending_anchor),rn(this.#main_effect,this.#offscreen_fragment)),this.#pending_effect===null&&(this.#pending_effect=V(()=>e(this.#anchor)))}#update_pending_count(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#update_pending_count(e);return}this.#pending_count+=e,this.#pending_count===0&&(this.#pending=!1,this.#pending_effect&&Qt(this.#pending_effect,()=>{this.#pending_effect=null}),this.#offscreen_fragment&&=(this.#anchor.before(this.#offscreen_fragment),null))}update_pending_count(e){this.#update_pending_count(e),this.#local_pending_count+=e,Le.add(this.#effect_pending_update)}get_effect_pending(){return this.#effect_pending_subscriber(),q(this.#effect_pending)}error(e){var t=this.#props.onerror;let n=this.#props.failed;if(this.#is_creating_fallback||!t&&!n)throw e;this.#main_effect&&=(H(this.#main_effect),null),this.#pending_effect&&=(H(this.#pending_effect),null),this.#failed_effect&&=(H(this.#failed_effect),null),k&&(j(this.#hydrate_open),he(),j(ge()));var r=!1,i=!1;let a=()=>{if(r){fe();return}r=!0,i&&le(),He.ensure(),this.#local_pending_count=0,this.#failed_effect!==null&&Qt(this.#failed_effect,()=>{this.#failed_effect=null}),this.#pending=this.has_pending_snippet(),this.#main_effect=this.#run(()=>(this.#is_creating_fallback=!1,V(()=>this.#children(this.#anchor)))),this.#pending_count>0?this.#show_pending_snippet():this.#pending=!1};var o=U;try{W(null),i=!0,t?.(e,a),i=!1}catch(e){Me(e,this.#effect&&this.#effect.parent)}finally{W(o)}n&&Oe(()=>{this.#failed_effect=this.#run(()=>{He.ensure(),this.#is_creating_fallback=!0;try{return V(()=>{n(this.#anchor,()=>e,()=>a)})}catch(e){return Me(e,this.#effect.parent),null}finally{this.#is_creating_fallback=!1}})})}};function tt(e,t,n){let r=Te()?it:ot;if(t.length===0){n(e.map(r));return}var i=N,a=G,o=nt(),s=k;Promise.all(t.map(e=>at(e))).then(t=>{o();try{n([...e.map(r),...t])}catch(e){a.f&16384||Me(e,a)}s&&pe(!1),i?.deactivate(),rt()}).catch(e=>{Me(e,a)})}function nt(){var e=G,t=U,n=xe,r=N,i=k;if(i)var a=A;return function(){un(e),W(t),Se(n),r?.activate(),i&&(pe(!0),j(a))}}function rt(){un(null),W(null),Se(null)}function it(e){var t=2|m,n=U!==null&&U.f&2?U:null;return G===null||n!==null&&n.f&256?t|=256:G.f|=v,{ctx:xe,deps:null,effects:null,equals:ve,f:t,fn:e,reactions:null,rv:0,v:O,wv:0,parent:n??G,ac:null}}function at(e,t){let n=G;n===null&&T();var r=n.b,i=void 0,a=ft(O),o=!U,s=new Map;return Wt(()=>{var t=f();i=t.promise;try{Promise.resolve(e()).then(t.resolve,t.reject).then(()=>{n===N&&n.committed&&n.deactivate(),rt()})}catch(e){t.reject(e),rt()}var n=N;if(o){var c=!r.is_pending();r.update_pending_count(1),n.increment(c),s.get(n)?.reject(w),s.delete(n),s.set(n,t)}let l=(e,t=void 0)=>{if(n.activate(),t)t!==w&&(a.f|=x,mt(a,t));else{a.f&8388608&&(a.f^=x),mt(a,e);for(let[e,t]of s){if(s.delete(e),e===n)break;t.reject(w)}}o&&(r.update_pending_count(-1),n.decrement(c))};t.promise.then(l,e=>l(null,e||`unknown`))}),zt(()=>{for(let e of s.values())e.reject(w)}),new Promise(e=>{function t(n){function r(){n===i?e(a):t(i)}n.then(r,r)}t(i)})}function P(e){let t=it(e);return fn(t),t}function ot(e){let t=it(e);return t.equals=be,t}function st(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)H(t[n])}}function ct(e){for(var t=e.parent;t!==null;){if(!(t.f&2))return t;t=t.parent}return null}function lt(e){var t,n=G;un(ct(e));try{e.f&=~y,st(e),t=wn(e)}finally{un(n)}return t}function ut(e){var t=lt(e);if(e.equals(t)||(e.v=t,e.wv=xn()),!sn)if(Ie!==null)Ie.set(e,e.v);else{var n=(bn||e.f&256)&&e.deps!==null?h:p;J(e,n)}}const dt=new Map;function ft(e,t){return{f:0,v:e,reactions:null,equals:ve,rv:0,wv:0}}function F(e,t){let n=ft(e,t);return fn(n),n}function pt(e,t=!1,n=!0){let r=ft(e);return t||(r.equals=be),r}function I(e,t,n=!1){U!==null&&(!ln||U.f&131072)&&Te()&&U.f&4325394&&!dn?.includes(e)&&ce();let r=n?_t(t):t;return mt(e,r)}function mt(e,t){if(!e.equals(t)){var n=e.v;sn?dt.set(e,t):dt.set(e,n),e.v=t,He.ensure().capture(e,n),e.f&2&&(e.f&2048&&lt(e),J(e,e.f&256?h:p)),e.wv=xn(),gt(e,m),Te()&&G!==null&&G.f&1024&&!(G.f&96)&&(mn===null?hn([e]):mn.push(e))}return t}function ht(e){I(e,e.v+1)}function gt(e,t){var n=e.reactions;if(n!==null)for(var r=Te(),i=n.length,a=0;a<i;a++){var o=n[a],s=o.f;if(!(!r&&o===G)){var c=(s&m)===0;c&&J(o,t),s&2?s&32768||(o.f|=y,gt(o,h)):c&&(s&16&&Ke!==null&&Ke.add(o),Xe(o))}}}function _t(t){if(typeof t!=`object`||!t||S in t)return t;let n=c(t);if(n!==o&&n!==s)return t;var r=new Map,a=e(t),l=F(0),u=null,d=vn,f=e=>{if(vn===d)return e();var t=U,n=vn;W(null),yn(d);var r=e();return W(t),yn(n),r};return a&&r.set(`length`,F(t.length,u)),new Proxy(t,{defineProperty(e,t,n){(!(`value`in n)||n.configurable===!1||n.enumerable===!1||n.writable===!1)&&oe();var i=r.get(t);return i===void 0?i=f(()=>{var e=F(n.value,u);return r.set(t,e),e}):I(i,n.value,!0),!0},deleteProperty(e,t){var n=r.get(t);if(n===void 0){if(t in e){let e=f(()=>F(O,u));r.set(t,e),ht(l)}}else I(n,O),ht(l);return!0},get(e,n,a){if(n===S)return t;var o=r.get(n),s=n in e;if(o===void 0&&(!s||i(e,n)?.writable)&&(o=f(()=>{var t=_t(s?e[n]:O);return F(t,u)}),r.set(n,o)),o!==void 0){var c=q(o);return c===O?void 0:c}return Reflect.get(e,n,a)},getOwnPropertyDescriptor(e,t){var n=Reflect.getOwnPropertyDescriptor(e,t);if(n&&`value`in n){var i=r.get(t);i&&(n.value=q(i))}else if(n===void 0){var a=r.get(t),o=a?.v;if(a!==void 0&&o!==O)return{enumerable:!0,configurable:!0,value:o,writable:!0}}return n},has(e,t){if(t===S)return!0;var n=r.get(t),a=n!==void 0&&n.v!==O||Reflect.has(e,t);return(n!==void 0||G!==null&&(!a||i(e,t)?.writable))&&(n===void 0&&(n=f(()=>{var n=a?_t(e[t]):O;return F(n,u)}),r.set(t,n)),q(n)===O)?!1:a},set(e,t,n,o){var s=r.get(t),c=t in e;if(a&&t===`length`)for(var d=n;d<s.v;d+=1){var p=r.get(d+``);p===void 0?d in e&&(p=f(()=>F(O,u)),r.set(d+``,p)):I(p,O)}if(s===void 0)(!c||i(e,t)?.writable)&&(s=f(()=>F(void 0,u)),I(s,_t(n)),r.set(t,s));else{c=s.v!==O;var m=f(()=>_t(n));I(s,m)}var h=Reflect.getOwnPropertyDescriptor(e,t);if(h?.set&&h.set.call(o,n),!c){if(a&&typeof t==`string`){var g=r.get(`length`),_=Number(t);Number.isInteger(_)&&_>=g.v&&I(g,_+1)}ht(l)}return!0},ownKeys(e){q(l);var t=Reflect.ownKeys(e).filter(e=>{var t=r.get(e);return t===void 0||t.v!==O});for(var[n,i]of r)i.v!==O&&!(n in e)&&t.push(n);return t},setPrototypeOf(){se()}})}function vt(e){try{if(typeof e==`object`&&e&&S in e)return e[S]}catch{}return e}function yt(e,t){return Object.is(vt(e),vt(t))}var bt,xt,St,Ct;function wt(){if(bt===void 0){bt=window,document,xt=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;St=i(t,`firstChild`).get,Ct=i(t,`nextSibling`).get,l(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),l(n)&&(n.__t=void 0)}}function L(e=``){return document.createTextNode(e)}function Tt(e){return St.call(e)}function Et(e){return Ct.call(e)}function R(e,t){if(!k)return Tt(e);var n=Tt(A);if(n===null)n=A.appendChild(L());else if(t&&n.nodeType!==3){var r=L();return n?.before(r),j(r),r}return j(n),n}function Dt(e,t=!1){if(!k){var n=Tt(e);return n instanceof Comment&&n.data===``?Et(n):n}if(t&&A?.nodeType!==3){var r=L();return A?.before(r),j(r),r}return A}function z(e,t=1,n=!1){let r=k?A:e;for(var i;t--;)i=r,r=Et(r);if(!k)return r;if(n&&r?.nodeType!==3){var a=L();return r===null?i?.after(a):r.before(a),j(a),a}return j(r),r}function Ot(e){e.textContent=``}function kt(){return!1}function At(e,t){if(t){let t=document.body;e.autofocus=!0,Oe(()=>{document.activeElement===t&&e.focus()})}}var jt=!1;function Mt(){jt||(jt=!0,document.addEventListener(`reset`,e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(let t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function Nt(e){var t=U,n=G;W(null),un(null);try{return e()}finally{W(t),un(n)}}function Pt(e,t,n,r=n){e.addEventListener(t,()=>Nt(n));let i=e.__on_r;i?e.__on_r=()=>{i(),r(!0)}:e.__on_r=()=>r(!0),Mt()}function Ft(e){G===null&&U===null&&re(e),U!==null&&U.f&256&&G===null&&ne(),sn&&E(e)}function It(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function Lt(e,t,n,r=!0){var i=G;i!==null&&i.f&8192&&(e|=g);var a={ctx:xe,deps:null,nodes_start:null,nodes_end:null,f:e|m,first:null,fn:t,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{Dn(a),a.f|=32768}catch(e){throw H(a),e}else t!==null&&Xe(a);if(r){var o=a;if(n&&o.deps===null&&o.teardown===null&&o.nodes_start===null&&o.first===o.last&&!(o.f&524288)&&(o=o.first,e&16&&e&65536&&o!==null&&(o.f|=_)),o!==null&&(o.parent=i,i!==null&&It(o,i),U!==null&&U.f&2&&!(e&64))){var s=U;(s.effects??=[]).push(o)}}return a}function Rt(){return U!==null&&!ln}function zt(e){let t=Lt(8,null,!1);return J(t,p),t.teardown=e,t}function Bt(e){Ft(`$effect`);var t=G.f;if(!U&&t&32&&!(t&32768)){var n=xe;(n.e??=[]).push(e)}else return Vt(e)}function Vt(e){return Lt(1048580,e,!1)}function Ht(e){He.ensure();let t=Lt(64|v,e,!0);return(e={})=>new Promise(n=>{e.outro?Qt(t,()=>{H(t),n(void 0)}):(H(t),n(void 0))})}function Ut(e){return Lt(4,e,!1)}function Wt(e){return Lt(4194304|v,e,!0)}function Gt(e,t=0){return Lt(8|t,e,!0)}function B(e,t=[],n=[]){tt(t,n,t=>{Lt(8,()=>e(...t.map(q)),!0)})}function Kt(e,t=0){return Lt(16|t,e,!0)}function V(e,t=!0){return Lt(32|v,e,!0,t)}function qt(e){var t=e.teardown;if(t!==null){let e=sn,n=U;cn(!0),W(null);try{t.call(null)}finally{cn(e),W(n)}}}function Jt(e,t=!1){var n=e.first;for(e.first=e.last=null;n!==null;){let e=n.ac;e!==null&&Nt(()=>{e.abort(w)});var r=n.next;n.f&64?n.parent=null:H(n,t),n=r}}function Yt(e){for(var t=e.first;t!==null;){var n=t.next;t.f&32||H(t),t=n}}function H(e,t=!0){var n=!1;(t||e.f&262144)&&e.nodes_start!==null&&e.nodes_end!==null&&(Xt(e.nodes_start,e.nodes_end),n=!0),Jt(e,t&&!n),En(e,0),J(e,16384);var r=e.transitions;if(r!==null)for(let e of r)e.stop();qt(e);var i=e.parent;i!==null&&i.first!==null&&Zt(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function Xt(e,t){for(;e!==null;){var n=e===t?null:Et(e);e.remove(),e=n}}function Zt(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function Qt(e,t,n=!0){var r=[];en(e,r,!0),$t(r,()=>{n&&H(e),t&&t()})}function $t(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var i of e)i.out(r)}else t()}function en(e,t,n){if(!(e.f&8192)){if(e.f^=g,e.transitions!==null)for(let r of e.transitions)(r.is_global||n)&&t.push(r);for(var r=e.first;r!==null;){var i=r.next,a=(r.f&65536)!=0||(r.f&32)!=0&&(e.f&16)!=0;en(r,t,a?n:!1),r=i}}}function tn(e){nn(e,!0)}function nn(e,t){if(e.f&8192){e.f^=g,e.f&1024||(J(e,m),Xe(e));for(var n=e.first;n!==null;){var r=n.next,i=(n.f&65536)!=0||(n.f&32)!=0;nn(n,i?t:!1),n=r}if(e.transitions!==null)for(let n of e.transitions)(n.is_global||t)&&n.in()}}function rn(e,t){for(var n=e.nodes_start,r=e.nodes_end;n!==null;){var i=n===r?null:Et(n);t.append(n),n=i}}let an=!1;function on(e){an=e}let sn=!1;function cn(e){sn=e}let U=null,ln=!1;function W(e){U=e}let G=null;function un(e){G=e}let dn=null;function fn(e){U!==null&&(dn===null?dn=[e]:dn.push(e))}var K=null,pn=0;let mn=null;function hn(e){mn=e}let gn=1;var _n=0;let vn=_n;function yn(e){vn=e}let bn=!1;function xn(){return++gn}function Sn(e){var t=e.f;if(t&2048)return!0;if(t&4096){var n=e.deps,r=(t&256)!=0;if(t&2&&(e.f&=~y),n!==null){var i,a,o=(t&512)!=0,s=r&&G!==null&&!bn,c=n.length;if((o||s)&&(G===null||!(G.f&16384))){var l=e,u=l.parent;for(i=0;i<c;i++)a=n[i],(o||!a?.reactions?.includes(l))&&(a.reactions??=[]).push(l);o&&(l.f^=512),s&&u!==null&&!(u.f&256)&&(l.f^=256)}for(i=0;i<c;i++)if(a=n[i],Sn(a)&&ut(a),a.wv>e.wv)return!0}(!r||G!==null&&!bn)&&J(e,p)}return!1}function Cn(e,t,n=!0){var r=e.reactions;if(r!==null&&!dn?.includes(e))for(var i=0;i<r.length;i++){var a=r[i];a.f&2?Cn(a,t,!1):t===a&&(n?J(a,m):a.f&1024&&J(a,h),Xe(a))}}function wn(e){var t=K,n=pn,r=mn,i=U,a=bn,o=dn,s=xe,c=ln,l=vn,u=e.f;K=null,pn=0,mn=null,bn=(u&256)!=0&&(ln||!an||U===null),U=u&96?null:e,dn=null,Se(e.ctx),ln=!1,vn=++_n,e.ac!==null&&(Nt(()=>{e.ac.abort(w)}),e.ac=null);try{e.f|=b;var d=e.fn,f=d(),p=e.deps;if(K!==null){var m;if(En(e,pn),p!==null&&pn>0)for(p.length=pn+K.length,m=0;m<K.length;m++)p[pn+m]=K[m];else e.deps=p=K;if(!bn||u&2&&e.reactions!==null)for(m=pn;m<p.length;m++)(p[m].reactions??=[]).push(e)}else p!==null&&pn<p.length&&(En(e,pn),p.length=pn);if(Te()&&mn!==null&&!ln&&p!==null&&!(e.f&6146))for(m=0;m<mn.length;m++)Cn(mn[m],e);return i!==null&&i!==e&&(_n++,mn!==null&&(r===null?r=mn:r.push(...mn))),e.f&8388608&&(e.f^=x),f}catch(e){return je(e)}finally{e.f^=b,K=t,pn=n,mn=r,U=i,bn=a,dn=o,Se(s),ln=c,vn=l}}function Tn(e,n){let r=n.reactions;if(r!==null){var i=t.call(r,e);if(i!==-1){var a=r.length-1;a===0?r=n.reactions=null:(r[i]=r[a],r.pop())}}r===null&&n.f&2&&(K===null||!K.includes(n))&&(J(n,h),n.f&768||(n.f^=512),st(n),En(n,0))}function En(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)Tn(e,n[r])}function Dn(e){var t=e.f;if(!(t&16384)){J(e,p);var n=G,r=an;G=e,an=!0;try{t&16?Yt(e):Jt(e),qt(e);var i=wn(e);e.teardown=typeof i==`function`?i:null,e.wv=gn}finally{an=r,G=n}}}async function On(){await Promise.resolve(),Ue()}function q(e){var t=(e.f&2)!=0;if(null?.add(e),U!==null&&!ln){if(!(G!==null&&G.f&16384)&&!dn?.includes(e)){var n=U.deps;if(U.f&2097152)e.rv<_n&&(e.rv=_n,K===null&&n!==null&&n[pn]===e?pn++:K===null?K=[e]:(!bn||!K.includes(e))&&K.push(e));else{(U.deps??=[]).push(e);var r=e.reactions;r===null?e.reactions=[U]:r.includes(U)||r.push(U)}}}else if(t&&e.deps===null&&e.effects===null){var i=e,a=i.parent;a!==null&&!(a.f&256)&&(i.f^=256)}if(sn){if(dt.has(e))return dt.get(e);if(t){i=e;var o=i.v;return(!(i.f&1024)&&i.reactions!==null||kn(i))&&(o=lt(i)),dt.set(i,o),o}}else if(t){if(i=e,Ie?.has(i))return Ie.get(i);Sn(i)&&ut(i)}if(Ie?.has(e))return Ie.get(e);if(e.f&8388608)throw e.v;return e.v}function kn(e){if(e.v===O)return!0;if(e.deps===null)return!1;for(let t of e.deps)if(dt.has(t)||t.f&2&&kn(t))return!0;return!1}function An(e){var t=ln;try{return ln=!0,e()}finally{ln=t}}var jn=~(h|3072);function J(e,t){e.f=e.f&jn|t}function Mn(e){if(!(typeof e!=`object`||!e||e instanceof EventTarget)){if(S in e)Nn(e);else if(!Array.isArray(e))for(let t in e){let n=e[t];typeof n==`object`&&n&&S in n&&Nn(n)}}}function Nn(e,t=new Set){if(typeof e==`object`&&e&&!(e instanceof EventTarget)&&!t.has(e)){for(let n in t.add(e),e instanceof Date&&e.getTime(),e)try{Nn(e[n],t)}catch{}let n=c(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){let t=a(n);for(let n in t){let r=t[n].get;if(r)try{r.call(e)}catch{}}}}}function Pn(e){return e.endsWith(`capture`)&&e!==`gotpointercapture`&&e!==`lostpointercapture`}var Fn=[`beforeinput`,`click`,`change`,`dblclick`,`contextmenu`,`focusin`,`focusout`,`input`,`keydown`,`keyup`,`mousedown`,`mousemove`,`mouseout`,`mouseover`,`mouseup`,`pointerdown`,`pointermove`,`pointerout`,`pointerover`,`pointerup`,`touchend`,`touchmove`,`touchstart`];function In(e){return Fn.includes(e)}var Ln=`allowfullscreen.async.autofocus.autoplay.checked.controls.default.disabled.formnovalidate.indeterminate.inert.ismap.loop.multiple.muted.nomodule.novalidate.open.playsinline.readonly.required.reversed.seamless.selected.webkitdirectory.defer.disablepictureinpicture.disableremoteplayback`.split(`.`),Rn={formnovalidate:`formNoValidate`,ismap:`isMap`,nomodule:`noModule`,playsinline:`playsInline`,readonly:`readOnly`,defaultvalue:`defaultValue`,defaultchecked:`defaultChecked`,srcobject:`srcObject`,novalidate:`noValidate`,allowfullscreen:`allowFullscreen`,disablepictureinpicture:`disablePictureInPicture`,disableremoteplayback:`disableRemotePlayback`};function zn(e){return e=e.toLowerCase(),Rn[e]??e}[...Ln];var Bn=[`touchstart`,`touchmove`];function Vn(e){return Bn.includes(e)}const Hn=new Set,Un=new Set;function Wn(e,t,n,r={}){function i(e){if(r.capture||Jn.call(t,e),!e.cancelBubble)return Nt(()=>n?.call(this,e))}return e.startsWith(`pointer`)||e.startsWith(`touch`)||e===`wheel`?Oe(()=>{t.addEventListener(e,i,r)}):t.addEventListener(e,i,r),i}function Gn(e,t,n,r,i){var a={capture:r,passive:i},o=Wn(e,t,n,a);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&zt(()=>{t.removeEventListener(e,o,a)})}function Kn(e){for(var t=0;t<e.length;t++)Hn.add(e[t]);for(var n of Un)n(e)}var qn=null;function Jn(t){var n=this,i=n.ownerDocument,a=t.type,o=t.composedPath?.()||[],s=o[0]||t.target;qn=t;var c=0,l=qn===t&&t.__root;if(l){var u=o.indexOf(l);if(u!==-1&&(n===document||n===window)){t.__root=n;return}var d=o.indexOf(n);if(d===-1)return;u<=d&&(c=u)}if(s=o[c]||t.target,s!==n){r(t,`currentTarget`,{configurable:!0,get(){return s||i}});var f=U,p=G;W(null),un(null);try{for(var m,h=[];s!==null;){var g=s.assignedSlot||s.parentNode||s.host||null;try{var _=s[`__`+a];if(_!=null&&(!s.disabled||t.target===s))if(e(_)){var[v,...y]=_;v.apply(s,[t,...y])}else _.call(s,t)}catch(e){m?h.push(e):m=e}if(t.cancelBubble||g===n||g===null)break;s=g}if(m){for(let e of h)queueMicrotask(()=>{throw e});throw m}}finally{t.__root=n,delete t.currentTarget,W(f),un(p)}}}function Yn(e){var t=document.createElement(`template`);return t.innerHTML=e.replaceAll(`<!>`,`<!---->`),t.content}function Xn(e,t){var n=G;n.nodes_start===null&&(n.nodes_start=e,n.nodes_end=t)}function Y(e,t){var n=(t&1)!=0,r=(t&2)!=0,i,a=!e.startsWith(`<!>`);return()=>{if(k)return Xn(A,null),A;i===void 0&&(i=Yn(a?e:`<!>`+e),n||(i=Tt(i)));var t=r||xt?document.importNode(i,!0):i.cloneNode(!0);if(n){var o=Tt(t),s=t.lastChild;Xn(o,s)}else Xn(t,t);return t}}function Zn(e=``){if(!k){var t=L(e+``);return Xn(t,t),t}var n=A;return n.nodeType!==3&&(n.before(n=L()),j(n)),Xn(n,n),n}function Qn(){if(k)return Xn(A,null),A;var e=document.createDocumentFragment(),t=document.createComment(``),n=L();return e.append(t,n),Xn(t,n),e}function X(e,t){if(k){G.nodes_end=A,me();return}e!==null&&e.before(t)}function Z(e,t){var n=t==null?``:typeof t==`object`?t+``:t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+``)}function $n(e,t){return tr(e,t)}var er=new Map;function tr(e,{target:t,anchor:r,props:i={},events:a,context:o,intro:s=!0}){wt();var c=new Set,l=e=>{for(var n=0;n<e.length;n++){var r=e[n];if(!c.has(r)){c.add(r);var i=Vn(r);t.addEventListener(r,Jn,{passive:i});var a=er.get(r);a===void 0?(document.addEventListener(r,Jn,{passive:i}),er.set(r,1)):er.set(r,a+1)}}};l(n(Hn)),Un.add(l);var u=void 0,d=Ht(()=>{var n=r??t.appendChild(L());return $e(n,{pending:()=>{}},t=>{if(o){Ce({});var n=xe;n.c=o}if(a&&(i.$$events=a),k&&Xn(t,null),u=e(t,i)||{},k&&(G.nodes_end=A,A===null||A.nodeType!==8||A.data!==`]`))throw ue(),D;o&&we()}),()=>{for(var e of c){t.removeEventListener(e,Jn);var i=er.get(e);--i===0?(document.removeEventListener(e,Jn),er.delete(e)):er.set(e,i)}Un.delete(l),n!==r&&n.parentNode?.removeChild(n)}});return nr.set(u,d),u}var nr=new WeakMap,rr=class{anchor;#batches=new Map;#onscreen=new Map;#offscreen=new Map;#transition=!0;constructor(e,t=!0){this.anchor=e,this.#transition=t}#commit=()=>{var e=N;if(this.#batches.has(e)){var t=this.#batches.get(e),n=this.#onscreen.get(t);if(n)tn(n);else{var r=this.#offscreen.get(t);r&&(this.#onscreen.set(t,r.effect),this.#offscreen.delete(t),r.fragment.lastChild.remove(),this.anchor.before(r.fragment),n=r.effect)}for(let[t,n]of this.#batches){if(this.#batches.delete(t),t===e)break;let r=this.#offscreen.get(n);r&&(H(r.effect),this.#offscreen.delete(n))}for(let[e,r]of this.#onscreen){if(e===t)continue;let i=()=>{if(Array.from(this.#batches.values()).includes(e)){var t=document.createDocumentFragment();rn(r,t),t.append(L()),this.#offscreen.set(e,{effect:r,fragment:t})}else H(r);this.#onscreen.delete(e)};this.#transition||!n?Qt(r,i,!1):i()}}};ensure(e,t){var n=N,r=kt();if(t&&!this.#onscreen.has(e)&&!this.#offscreen.has(e))if(r){var i=document.createDocumentFragment(),a=L();i.append(a),this.#offscreen.set(e,{effect:V(()=>t(a)),fragment:i})}else this.#onscreen.set(e,V(()=>t(this.anchor)));if(this.#batches.set(n,e),r){for(let[t,r]of this.#onscreen)t===e?n.skipped_effects.delete(r):n.skipped_effects.add(r);for(let[t,r]of this.#offscreen)t===e?n.skipped_effects.delete(r.effect):n.skipped_effects.add(r.effect);n.add_callback(this.#commit)}else k&&(this.anchor=A),this.#commit()}};function Q(e,t,n=!1){k&&me();var r=new rr(e),i=n?_:0;function a(t,n){if(k){let a=_e(e)===`[!`;if(t===a){var i=ge();j(i),r.anchor=i,pe(!1),r.ensure(t,n),pe(!0);return}}r.ensure(t,n)}Kt(()=>{var e=!1;t((t,n=!0)=>{e=!0,a(n,t)}),e||a(!1,null)},i)}let ir=null;function ar(e,t){return t}function or(e,t,n){for(var r=e.items,i=[],a=t.length,o=0;o<a;o++)en(t[o].e,i,!0);var s=a>0&&i.length===0&&n!==null;if(s){var c=n.parentNode;Ot(c),c.append(n),r.clear(),fr(e,t[0].prev,t[a-1].next)}$t(i,()=>{for(var n=0;n<a;n++){var i=t[n];s||(r.delete(i.k),fr(e,i.prev,i.next)),H(i.e,!s)}})}function sr(t,r,i,a,o,s=null){var c=t,l={flags:r,items:new Map,first:null};if(r&4){var u=t;c=k?j(Tt(u)):u.appendChild(L())}k&&me();var d=null,f=!1,p=new Map,m=ot(()=>{var t=i();return e(t)?t:t==null?[]:n(t)}),h,g;function _(){cr(g,h,l,p,c,o,r,a,i),s!==null&&(h.length===0?d?tn(d):d=V(()=>s(c)):d!==null&&Qt(d,()=>{d=null}))}Kt(()=>{g??=G,h=q(m);var e=h.length;if(f&&e===0)return;f=e===0;let t=!1;if(k&&_e(c)===`[!`!=(e===0)&&(c=ge(),j(c),pe(!1),t=!0),k){for(var n=null,u,v=0;v<e;v++){if(A.nodeType===8&&A.data===`]`){c=A,t=!0,pe(!1);break}var y=h[v],b=a(y,v);u=ur(A,l,n,null,y,b,v,o,r,i),l.items.set(b,u),n=u}e>0&&j(ge())}if(k)e===0&&s&&(d=V(()=>s(c)));else if(kt()){var x=new Set,S=N;for(v=0;v<e;v+=1){y=h[v],b=a(y,v);var C=l.items.get(b)??p.get(b);C?r&3&&lr(C,y,v,r):(u=ur(null,l,null,null,y,b,v,o,r,i,!0),p.set(b,u)),x.add(b)}for(let[e,t]of l.items)x.has(e)||S.skipped_effects.add(t.e);S.add_callback(_)}else _();t&&pe(!0),q(m)}),k&&(c=A)}function cr(e,t,r,i,a,o,s,c,l){var u=(s&8)!=0,d=(s&3)!=0,f=t.length,p=r.items,m=r.first,h,g=null,_,v=[],y=[],b,x,S,C;if(u)for(C=0;C<f;C+=1)b=t[C],x=c(b,C),S=p.get(x),S!==void 0&&(S.a?.measure(),(_??=new Set).add(S));for(C=0;C<f;C+=1){if(b=t[C],x=c(b,C),S=p.get(x),S===void 0){var ee=i.get(x);if(ee!==void 0){i.delete(x),p.set(x,ee);var w=g?g.next:m;fr(r,g,ee),fr(r,ee,w),dr(ee,w,a),g=ee}else{var te=m?m.e.nodes_start:a;g=ur(te,r,g,g===null?r.first:g.next,b,x,C,o,s,l)}p.set(x,g),v=[],y=[],m=g.next;continue}if(d&&lr(S,b,C,s),S.e.f&8192&&(tn(S.e),u&&(S.a?.unfix(),(_??=new Set).delete(S))),S!==m){if(h!==void 0&&h.has(S)){if(v.length<y.length){var T=y[0],E;g=T.prev;var ne=v[0],re=v[v.length-1];for(E=0;E<v.length;E+=1)dr(v[E],T,a);for(E=0;E<y.length;E+=1)h.delete(y[E]);fr(r,ne.prev,re.next),fr(r,g,ne),fr(r,re,T),m=T,g=re,--C,v=[],y=[]}else h.delete(S),dr(S,m,a),fr(r,S.prev,S.next),fr(r,S,g===null?r.first:g.next),fr(r,g,S),g=S;continue}for(v=[],y=[];m!==null&&m.k!==x;)m.e.f&8192||(h??=new Set).add(m),y.push(m),m=m.next;if(m===null)continue;S=m}v.push(S),g=S,m=S.next}if(m!==null||h!==void 0){for(var ie=h===void 0?[]:n(h);m!==null;)m.e.f&8192||ie.push(m),m=m.next;var ae=ie.length;if(ae>0){var oe=s&4&&f===0?a:null;if(u){for(C=0;C<ae;C+=1)ie[C].a?.measure();for(C=0;C<ae;C+=1)ie[C].a?.fix()}or(r,ie,oe)}}u&&Oe(()=>{if(_!==void 0)for(S of _)S.a?.apply()}),e.first=r.first&&r.first.e,e.last=g&&g.e;for(var se of i.values())H(se.e);i.clear()}function lr(e,t,n,r){r&1&&mt(e.v,t),r&2?mt(e.i,n):e.i=n}function ur(e,t,n,r,i,a,o,s,c,l,u){var d=ir,f=(c&1)!=0,p=(c&16)==0,m=f?p?pt(i,!1,!1):ft(i):i,h=c&2?ft(o):o,g={i:h,v:m,k:a,a:null,e:null,prev:n,next:r};ir=g;try{return e===null&&document.createDocumentFragment().append(e=L()),g.e=V(()=>s(e,m,h,l),k),g.e.prev=n&&n.e,g.e.next=r&&r.e,n===null?u||(t.first=g):(n.next=g,n.e.next=g.e),r!==null&&(r.prev=g,r.e.prev=g.e),g}finally{ir=d}}function dr(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,i=t?t.e.nodes_start:n,a=e.e.nodes_start;a!==null&&a!==r;){var o=Et(a);i.before(a),a=o}}function fr(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function pr(e,t,...n){var r=new rr(e);Kt(()=>{let e=t()??null;r.ensure(e,e&&(t=>e(t,...n)))},_)}function mr(e,t,n){Ut(()=>{var r=An(()=>t(e,n?.())||{});if(n&&r?.update){var i=!1,a={};Gt(()=>{var e=n();Mn(e),i&&ye(a,e)&&(a=e,r.update(e))}),i=!0}if(r?.destroy)return()=>r.destroy()})}function hr(e,t){var n=void 0,r;Kt(()=>{n!==(n=t())&&(r&&=(H(r),null),n&&(r=V(()=>{Ut(()=>n(e))})))})}function gr(e){var t,n,r=``;if(typeof e==`string`||typeof e==`number`)r+=e;else if(typeof e==`object`)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=gr(e[t]))&&(r&&(r+=` `),r+=n)}else for(n in e)e[n]&&(r&&(r+=` `),r+=n);return r}function _r(){for(var e,t,n=0,r=``,i=arguments.length;n<i;n++)(e=arguments[n])&&(t=gr(e))&&(r&&(r+=` `),r+=t);return r}function vr(e){return typeof e==`object`?_r(e):e??``}var yr=[...` 	
\r\f\xA0\vï»¿`];function br(e,t,n){var r=e==null?``:``+e;if(t&&(r=r?r+` `+t:t),n){for(var i in n)if(n[i])r=r?r+` `+i:i;else if(r.length)for(var a=i.length,o=0;(o=r.indexOf(i,o))>=0;){var s=o+a;(o===0||yr.includes(r[o-1]))&&(s===r.length||yr.includes(r[s]))?r=(o===0?``:r.substring(0,o))+r.substring(s+1):o=s}}return r===``?null:r}function xr(e,t=!1){var n=t?` !important;`:`;`,r=``;for(var i in e){var a=e[i];a!=null&&a!==``&&(r+=` `+i+`: `+a+n)}return r}function Sr(e){return e[0]!==`-`||e[1]!==`-`?e.toLowerCase():e}function Cr(e,t){if(t){var n=``,r,i;if(Array.isArray(t)?(r=t[0],i=t[1]):r=t,e){e=String(e).replaceAll(/\s*\/\*.*?\*\/\s*/g,``).trim();var a=!1,o=0,s=!1,c=[];r&&c.push(...Object.keys(r).map(Sr)),i&&c.push(...Object.keys(i).map(Sr));var l=0,u=-1;let t=e.length;for(var d=0;d<t;d++){var f=e[d];if(s?f===`/`&&e[d-1]===`*`&&(s=!1):a?a===f&&(a=!1):f===`/`&&e[d+1]===`*`?s=!0:f===`"`||f===`'`?a=f:f===`(`?o++:f===`)`&&o--,!s&&a===!1&&o===0){if(f===`:`&&u===-1)u=d;else if(f===`;`||d===t-1){if(u!==-1){var p=Sr(e.substring(l,u).trim());if(!c.includes(p)){f!==`;`&&d++;var m=e.substring(l,d).trim();n+=` `+m+`;`}}l=d+1,u=-1}}}}return r&&(n+=xr(r)),i&&(n+=xr(i,!0)),n=n.trim(),n===``?null:n}return e==null?null:String(e)}function wr(e,t,n,r,i,a){var o=e.__className;if(k||o!==n||o===void 0){var s=br(n,r,a);(!k||s!==e.getAttribute(`class`))&&(s==null?e.removeAttribute(`class`):t?e.className=s:e.setAttribute(`class`,s)),e.__className=n}else if(a&&i!==a)for(var c in a){var l=!!a[c];(i==null||l!==!!i[c])&&e.classList.toggle(c,l)}return a}function Tr(e,t={},n,r){for(var i in n){var a=n[i];t[i]!==a&&(n[i]==null?e.style.removeProperty(i):e.style.setProperty(i,a,r))}}function Er(e,t,n,r){var i=e.__style;if(k||i!==t){var a=Cr(t,r);(!k||a!==e.getAttribute(`style`))&&(a==null?e.removeAttribute(`style`):e.style.cssText=a),e.__style=t}else r&&(Array.isArray(r)?(Tr(e,n?.[0],r[0]),Tr(e,n?.[1],r[1],`important`)):Tr(e,n,r));return r}function Dr(t,n,r=!1){if(t.multiple){if(n==null)return;if(!e(n))return de();for(var i of t.options)i.selected=n.includes(kr(i));return}for(i of t.options){var a=kr(i);if(yt(a,n)){i.selected=!0;return}}(!r||n!==void 0)&&(t.selectedIndex=-1)}function Or(e){var t=new MutationObserver(()=>{Dr(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:[`value`]}),zt(()=>{t.disconnect()})}function kr(e){return`__value`in e?e.__value:e.value}const Ar=Symbol(`class`),jr=Symbol(`style`);var Mr=Symbol(`is custom element`),Nr=Symbol(`is html`);function Pr(e){if(k){var t=!1,n=()=>{if(!t){if(t=!0,e.hasAttribute(`value`)){var n=e.value;Ir(e,`value`,null),e.value=n}if(e.hasAttribute(`checked`)){var r=e.checked;Ir(e,`checked`,null),e.checked=r}}};e.__on_r=n,Oe(n),Mt()}}function Fr(e,t){t?e.hasAttribute(`selected`)||e.setAttribute(`selected`,``):e.removeAttribute(`selected`)}function Ir(e,t,n,r){var i=zr(e);k&&(i[t]=e.getAttribute(t),t===`src`||t===`srcset`||t===`href`&&e.nodeName===`LINK`)||i[t]!==(i[t]=n)&&(t===`loading`&&(e[ee]=n),n==null?e.removeAttribute(t):typeof n!=`string`&&Vr(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function Lr(e,t,n,r,i=!1,a=!1){if(k&&i&&e.tagName===`INPUT`){var o=e;(o.type===`checkbox`?`defaultChecked`:`defaultValue`)in n||Pr(o)}var s=zr(e),c=s[Mr],l=!s[Nr];let u=k&&c;u&&pe(!1);var d=t||{},f=e.tagName===`OPTION`;for(var p in t)p in n||(n[p]=null);n.class?n.class=vr(n.class):(r||n[Ar])&&(n.class=null),n[jr]&&(n.style??=null);var m=Vr(e);for(let i in n){let o=n[i];if(f&&i===`value`&&o==null){e.value=e.__value=``,d[i]=o;continue}if(i===`class`){var h=e.namespaceURI===`http://www.w3.org/1999/xhtml`;wr(e,h,o,r,t?.[Ar],n[Ar]),d[i]=o,d[Ar]=n[Ar];continue}if(i===`style`){Er(e,o,t?.[jr],n[jr]),d[i]=o,d[jr]=n[jr];continue}var g=d[i];if(!(o===g&&!(o===void 0&&e.hasAttribute(i)))){d[i]=o;var _=i[0]+i[1];if(_!==`$$`)if(_===`on`){let t={},n=`$$`+i,r=i.slice(2);var v=In(r);if(Pn(r)&&(r=r.slice(0,-7),t.capture=!0),!v&&g){if(o!=null)continue;e.removeEventListener(r,d[n],t),d[n]=null}if(o!=null)if(v)e[`__${r}`]=o,Kn([r]);else{function a(e){d[i].call(this,e)}d[n]=Wn(r,e,a,t)}else v&&(e[`__${r}`]=void 0)}else if(i===`style`)Ir(e,i,o);else if(i===`autofocus`)At(e,!!o);else if(!c&&(i===`__value`||i===`value`&&o!=null))e.value=e.__value=o;else if(i===`selected`&&f)Fr(e,o);else{var y=i;l||(y=zn(y));var b=y===`defaultValue`||y===`defaultChecked`;if(o==null&&!c&&!b)if(s[i]=null,y===`value`||y===`checked`){let n=e,r=t===void 0;if(y===`value`){let e=n.defaultValue;n.removeAttribute(y),n.defaultValue=e,n.value=n.__value=r?e:null}else{let e=n.defaultChecked;n.removeAttribute(y),n.defaultChecked=e,n.checked=r?e:!1}}else e.removeAttribute(i);else b||m.includes(y)&&(c||typeof o!=`string`)?(e[y]=o,y in s&&(s[y]=O)):typeof o!=`function`&&Ir(e,y,o,a)}}}return u&&pe(!0),d}function Rr(e,t,n=[],r=[],i,a=!1,o=!1){tt(n,r,n=>{var r=void 0,s={},c=e.nodeName===`SELECT`,l=!1;if(Kt(()=>{var u=t(...n.map(q)),d=Lr(e,r,u,i,a,o);l&&c&&`value`in u&&Dr(e,u.value);for(let e of Object.getOwnPropertySymbols(s))u[e]||H(s[e]);for(let t of Object.getOwnPropertySymbols(u)){var f=u[t];t.description===`@attach`&&(!r||f!==r[t])&&(s[t]&&H(s[t]),s[t]=V(()=>hr(e,()=>f))),d[t]=f}r=d}),c){var u=e;Ut(()=>{Dr(u,r.value,!0),Or(u)})}l=!0})}function zr(e){return e.__attributes??={[Mr]:e.nodeName.includes(`-`),[Nr]:e.namespaceURI===`http://www.w3.org/1999/xhtml`}}var Br=new Map;function Vr(e){var t=e.getAttribute(`is`)||e.nodeName,n=Br.get(t);if(n)return n;Br.set(t,n=[]);for(var r,i=e,o=Element.prototype;o!==i;){for(var s in r=a(i),r)r[s].set&&n.push(s);i=c(i)}return n}function Hr(e,t,n=t){var r=new WeakSet;Pt(e,`input`,async i=>{var a=i?e.defaultValue:e.value;if(a=Wr(e)?Gr(a):a,n(a),N!==null&&r.add(N),await On(),a!==(a=t())){var o=e.selectionStart,s=e.selectionEnd,c=e.value.length;if(e.value=a??``,s!==null){var l=e.value.length;o===s&&s===c&&l>c?(e.selectionStart=l,e.selectionEnd=l):(e.selectionStart=o,e.selectionEnd=Math.min(s,l))}}}),(k&&e.defaultValue!==e.value||An(t)==null&&e.value)&&(n(Wr(e)?Gr(e.value):e.value),N!==null&&r.add(N)),Gt(()=>{var n=t();if(e===document.activeElement){var i=Fe??N;if(r.has(i))return}Wr(e)&&n===Gr(e.value)||e.type===`date`&&!n&&!e.value||n!==e.value&&(e.value=n??``)})}function Ur(e,t,n=t){Pt(e,`change`,t=>{var r=t?e.defaultChecked:e.checked;n(r)}),(k&&e.defaultChecked!==e.checked||An(t)==null)&&n(e.checked),Gt(()=>{e.checked=!!t()})}function Wr(e){var t=e.type;return t===`number`||t===`range`}function Gr(e){return e===``?null:+e}function Kr(e,t){return e===t||e?.[S]===t}function qr(e={},t,n,r){return Ut(()=>{var i,a;return Gt(()=>{i=a,a=r?.()||[],An(()=>{e!==n(...a)&&(t(e,...a),i&&Kr(n(...i),e)&&t(null,...i))})}),()=>{Oe(()=>{a&&Kr(n(...a),e)&&t(null,...a)})}}),e}var Jr=!1;function Yr(e){var t=Jr;try{return Jr=!1,[e(),Jr]}finally{Jr=t}}function Xr(e,t,n,r){var a=!0,o=(n&8)!=0,s=(n&16)!=0,c=r,l=!0,u=()=>(l&&(l=!1,c=s?An(r):r),c),d;if(o){var f=S in e||C in e;d=i(e,t)?.set??(f&&t in e?n=>e[t]=n:void 0)}var p,m=!1;o?[p,m]=Yr(()=>e[t]):p=e[t],p===void 0&&r!==void 0&&(p=u(),d&&(a&&ae(t),d(p)));var h=a?()=>{var n=e[t];return n===void 0?u():(l=!0,n)}:()=>{var n=e[t];return n!==void 0&&(c=void 0),n===void 0?c:n};if(a&&!(n&4))return h;if(d){var g=e.$$legacy;return(function(e,t){return arguments.length>0?((!a||!t||g||m)&&d(t?h():e),e):h()})}var _=!1,v=(n&1?it:ot)(()=>(_=!1,h()));o&&q(v);var y=G;return(function(e,t){if(arguments.length>0){let n=t?q(v):a&&o?_t(e):e;return I(v,n),_=!0,c!==void 0&&(c=n),e}return sn&&_||y.f&16384?v.v:q(v)})}function Zr(e){xe===null&&te(`onMount`),Bt(()=>{let t=An(e);if(typeof t==`function`)return t})}typeof window<`u`&&((window.__svelte??={}).v??=new Set).add(`5`);var Qr=Object.defineProperty,$r=(e,t,n)=>t in e?Qr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,$=(e,t,n)=>$r(e,typeof t==`symbol`?t:t+``,n);function ei(e){return new ti(e)}var ti=class extends EventTarget{constructor(e){super(),$(this,`onconnect`,null),$(this,`ondisconnect`,null),$(this,`devices`,new Map),this.api=e,this.addListener()}dispatchEvent(e){return e.type===`connect`&&this.onconnect&&this.onconnect.call(this,e),e.type===`disconnect`&&this.ondisconnect&&this.ondisconnect.call(this,e),super.dispatchEvent(e),!e.defaultPrevented}async getDevices(){let e=await this.requestGetDevices(),t=[];return e.forEach(e=>{if(this.devices.has(e.instanceId))t.push(this.devices.get(e.instanceId));else{let n=new ri(this.api,e);this.devices.set(e.instanceId,n),t.push(n)}}),t}async requestDevice(e){return e&&console.log(`Requesting device with options:`,e),this.getDevices()}async requestGetDevices(){return(await ni(this.api,`getDevices`,{})).devices}addListener(){this.api.addOverlayListener(`otk::hid::inputreport`,e=>this.callbackInputReport(e)),this.api.addOverlayListener(`otk::hid::devicechanged`,e=>this.callbackDeviceChanged(e))}callbackInputReport(e){let t=e.instanceId,n=si(e.data),r=this.devices.get(t);r?r.dispatchEvent(new ai(`inputreport`,r,n[0],new DataView(n.buffer,1))):console.warn(`Device not found:`,t)}callbackDeviceChanged(e){var t=e.add;let n=new ri(this.api,e.device),r=new ii(t?`connect`:`disconnect`,n);this.dispatchEvent(r)}};async function ni(e,t,n){let r={call:`otk::hid`,type:t,...n},i=await e.callOverlayHandler(r);return i.error&&console.log(`callOverlayHID error:`,t,n,i),i}var ri=class extends EventTarget{constructor(e,t){super(),$(this,`instanceId`),$(this,`opened`,!1),$(this,`vendorId`),$(this,`productId`),$(this,`productName`),$(this,`collections`),$(this,`oninputreport`,null),this.api=e,this.instanceId=t.instanceId,this.vendorId=t.vendorId,this.productId=t.productId,this.productName=t.productName,this.collections=t.collections||[]}dispatchEvent(e){return e.type===`inputreport`&&this.oninputreport&&this.oninputreport.call(this,e),super.dispatchEvent(e),!e.defaultPrevented}async open(){this.opened||=(await this.request(`open`,{}),!0)}async close(){this.opened&&=(await this.request(`close`,{}),!1)}async forget(){}async sendReport(e,t){if(!this.opened)throw Error(`Device is not opened.`);await this.request(`send`,{reportId:e,data:oi(t)})}async sendFeatureReport(e,t){if(!this.opened)throw Error(`Device is not opened.`);await this.request(`sendFeature`,{reportId:e,data:oi(t)})}async receiveFeatureReport(e){if(!this.opened)throw Error(`Device is not opened.`);let t=await this.request(`recvFeature`,{reportId:e}),n=si(t.data);return new DataView(n.buffer)}async request(e,t){return ni(this.api,e,{instanceId:this.instanceId,...t})}},ii=class extends Event{constructor(e,t){super(e),$(this,`device`),this.device=t}},ai=class extends Event{constructor(e,t,n,r){super(e),$(this,`device`),$(this,`reportId`),$(this,`data`),this.device=t,this.reportId=n,this.data=r}};function oi(e){let t=null;return t=e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength),[...t].map(e=>e.toString(16).padStart(2,`0`)).join(``)}function si(e){let t=new Uint8Array(Math.ceil(e.length/2));for(let n=0;n<e.length;)t[n/2]=Number.parseInt(e.slice(n,n+=2),16);return t}var ci=class{constructor(e=null){$(this,`subscribers`,new Map),$(this,`queue`,[]),this.transport=e,e&&this.setTransport(e)}setTransport(e){this.transport=e,this.transport.addEventListener(`message`,e=>{this.dispatchOverlayEvent(e.detail)}),this.transport.addEventListener(`connected`,this.onTransportConnected.bind(this))}dispatchOverlayEvent(e){let t=this.subscribers.get(e.type);if(t)for(let n of t)n(e)}addOverlayListener(e,t){this.subscribers.has(e)||this.subscribers.set(e,[]),this.subscribers.get(e).push(t)}removeOverlayListener(e,t){if(!this.subscribers.has(e))return;let n=this.subscribers.get(e),r=n.indexOf(t);r!==-1&&n.splice(r,1)}async callOverlayHandler(e){return!this.transport||!this.transport.connected?(console.warn(`OverlayPluginAPI: Transport not connected, queuing message`,e),new Promise(t=>{this.queue.push([e,t])})):this.transport.sendMessage(e)}startOverlayEvents(){var e={call:`subscribe`,events:Array.from(this.subscribers.keys())};this.callOverlayHandler(e)}onTransportConnected(){if(!this.transport||!this.transport.connected||this.queue.length===0)return;console.log(`OverlayPluginAPI: Transport connected, sending queued messages`);let e=this.queue;this.queue=[];for(let[t,n]of e)this.transport.sendMessage(t).then(n)}},li=class extends EventTarget{constructor(){super(...arguments),$(this,`connected`,!1),$(this,`evtHandlerWrapper`,e=>{this.dispatchEvent(new CustomEvent(`message`,{detail:e}))})}get transportType(){return`plugin`}sendMessage(e){return new Promise(t=>{window.OverlayPluginApi.callHandler(JSON.stringify(e),t)})}waitForApi(){if(!window.OverlayPluginApi||!window.OverlayPluginApi.ready){setTimeout(()=>this.waitForApi(),300);return}window.__OverlayCallback=this.evtHandlerWrapper,this.connected=!0,this.dispatchEvent(new Event(`connected`))}},ui=class extends EventTarget{constructor(e){super(),$(this,`ws`),$(this,`sequence`,0),$(this,`responseResolvers`,new Map),$(this,`evtHandler`,()=>{}),$(this,`connected`,!1),this.ws=new WebSocket(e),this.connect(this.ws)}connect(e){e.addEventListener(`open`,this.onOpen.bind(this)),e.addEventListener(`error`,this.onError.bind(this)),e.addEventListener(`message`,this.onMessage.bind(this)),e.addEventListener(`close`,this.onClosed.bind(this))}onError(e){console.error(e)}onOpen(){console.log(`WebSocket connected`),this.connected=!0,this.dispatchEvent(new Event(`connected`))}onMessage(e){try{let t=JSON.parse(e.data);if(`rseq`in t){let e=t.rseq;this.responseResolvers.has(e)&&(this.responseResolvers.get(e)(t),this.responseResolvers.delete(e))}else this.dispatchEvent(new CustomEvent(`message`,{detail:t}))}catch{console.error(`Failed to parse WebSocket message`,e)}}onClosed(e){console.log(`WebSocket closed`,e),this.connected=!1,setTimeout(()=>{console.log(`WebSocket reconnecting...`),this.ws=new WebSocket(this.ws.url),this.connect(this.ws)},3e3)}get transportType(){return`websocket`}sendMessage(e){let t=this.sequence++;return e.rseq=t,new Promise(n=>{this.responseResolvers.set(t,n),this.ws.send(JSON.stringify(e))})}set eventHandler(e){this.evtHandler=e}},di=class{constructor(){$(this,`hid`),$(this,`api`,new ci),$(this,`handlerMap`,new Map),this.hid=ei(this.api)}Fetch(e,t={}){let n={call:`Fetch`,resource:e,options:t};return this.api.callOverlayHandler(n)}async SubscribePacket(e,t,n){let r={call:`otk::packet`,action:`subscribe`,name:e,evt_name:`otk::packet::`+e,filters:t},i=await this.api.callOverlayHandler(r);if(i.error)throw Error(i.error);return i.evt_name?(this.api.addOverlayListener(i.evt_name,e=>this.packetHandler(e,!1)),this.api.startOverlayEvents()):console.warn(`plugin does not support evt_name for packet subscription, may < 0.4.0`),this.handlerMap.set(i.name||e,{handler:n,evt_name:i.evt_name}),i.name||e}async UnsubscribePacket(e){let t={call:`otk::packet`,action:`unsubscribe`,name:e},n=await this.api.callOverlayHandler(t);if(n.error)throw Error(n.error);this.handlerMap.delete(e)}packetHandler(e,t=!1){let n=e,r=e;r.data=Uint8Array.from(atob(n.msg),e=>e.charCodeAt(0));let i=this.handlerMap.get(n.name);if(i){if(t&&i.evt_name)return;i.handler(r)}else t||console.warn(`No packet handler for name`,n.name)}async GetGameVersion(){return this.api.callOverlayHandler({call:`otk::game_ver`})}async GetPluginVersion(){return(await this.api.callOverlayHandler({call:`otk::plugin_ver`})).version}Start(){this.api.addOverlayListener(`otk::packet`,e=>this.packetHandler(e,!0)),this.api.startOverlayEvents()}Dispatch(e){this.api.dispatchOverlayEvent(e)}AddListener(e,t){this.api.addOverlayListener(e,t)}RemoveListener(e,t){this.api.removeOverlayListener(e,t)}Call(e){return this.api.callOverlayHandler(e)}IsOverlayPluginCEF(){return`OverlayPluginApi`in window}tryConnectToCEF(){if(!this.IsOverlayPluginCEF()){setTimeout(()=>this.tryConnectToCEF(),300);return}let e=new li;this.api.setTransport(e),e.waitForApi()}Connect(e=``){if(this.tryConnectToCEF(),e||=new URLSearchParams(location.search).get(`OVERLAY_WS`),e){if(this.IsOverlayPluginCEF()){console.warn(`OverlayToolkit: Connect wsUrl ignored in OverlayPlugin CEF environment`);return}let t=new ui(e);this.api.setTransport(t)}}},fi=new di;(function(){fi.Connect()})();const pi={smoothScroll:!0,shouldThrowOnBounds:!0,align:`auto`},mi=(e,t,n)=>{if(e===0)return 0;let r=e*t;return Math.max(0,r-n)},hi=(e,t,n,r,i,a,o,s,c,l,u)=>{if(a===`bottomToTop`){let a=Math.ceil(t/n)+1,o=l??r*n,s=Math.max(0,o-t)-e,c=Math.floor(s/n);if(c<0)return{start:0,end:Math.min(r,a+i*2)};let u=Math.max(0,c-i),d=Math.min(r,c+a+i);return{start:u,end:d}}else{let a=Math.floor(e/n),o=Math.min(r,a+Math.ceil(t/n)+1),s=l??r*n,c=Math.max(0,s-t),d=Math.max(1,Math.floor(n*.25));if(Math.abs(e-c)<=d){let e=r,a=e,o=0,s=e=>{let t=u?u[e]:void 0;return Number.isFinite(t)&&t>0?t:n};for(;a>0&&o<t;){let e=s(a-1);o+=e,--a}return{start:Math.max(0,a-i),end:e}}let f=Math.max(0,a-i),p=Math.min(r,o+i);return{start:f,end:p}}},gi=(e,t,n,r,i,a,o,s,c)=>{let l=a||c||0;if(e===`bottomToTop`){let e=o??t*i,r=(t-n)*i,a=Math.max(0,l-e);return r+a}else{if(s){let e=yi(s,i,r);return Math.max(0,Math.round(e))}return r*i}},_i=(e,t,n=!1)=>{let{initialized:r,mode:i,containerElement:a,viewportElement:o,calculatedItemHeight:s,scrollTop:c}=e,{setHeight:l,setScrollTop:u}=t;if(n&&a&&o&&r){let e=a.getBoundingClientRect().height;if(l(e),i===`bottomToTop`){let e=Math.floor(c/s)*s;o.scrollTop=e,u(e)}}},vi=(e,t,n,r,i,a=0,o=0,s=`topToBottom`)=>{let c=e.filter(e=>e);if(c.length===0)return{newHeight:r,newLastMeasuredIndex:t.start,updatedHeightCache:n,clearedDirtyItems:new Set,newTotalHeight:a,newValidCount:o,heightChanges:[]};let l={...n},u=new Set,d=[],f=a,p=o;return i.size>0?i.forEach(e=>{let n;n=s===`bottomToTop`?c.length-1-(e-t.start):e-t.start;let i=c[n];if(i&&n>=0&&n<c.length)try{i.offsetHeight;let t=i.getBoundingClientRect().height,n=l[e];if(Number.isFinite(t)&&t>0&&(!n||Math.abs(n-t)>=.1)){let i=n||r,a=t-i;d.push({index:e,oldHeight:i,newHeight:t,delta:a}),n&&Number.isFinite(n)&&n>0?f=f-n+t:(f+=t,p++),l[e]=t}u.add(e)}catch{u.add(e)}else u.add(e)}):c.forEach((e,n)=>{let r=s===`bottomToTop`?Math.max(0,(t.end??t.start+c.length)-1-n):t.start+n;if(!l[r])try{let t=e.getBoundingClientRect().height;Number.isFinite(t)&&t>0&&(f+=t,p++,l[r]=t)}catch{}}),{newHeight:p>0?f/p:r,newLastMeasuredIndex:t.start,updatedHeightCache:l,clearedDirtyItems:u,newTotalHeight:f,newValidCount:p,heightChanges:d}},yi=(e,t,n,r,i=1e3)=>{let a=Math.max(0,Math.floor(n));if(a<=0)return 0;if(!r){let n=0;for(let r=0;r<a;r++){let i=e[r];n+=Number.isFinite(i)&&i>0?i:t}return n}let o=Math.floor(a/i),s=0;if(o>0){let e=r[o-1];s=Number.isFinite(e)?e:0}let c=s,l=o*i;for(let n=l;n<a;n++){let r=e[n];c+=Number.isFinite(r)&&r>0?r:t}return c},bi=(e,t,n,r,i,a,o,s,c,l,u=0,d=0,f=`topToBottom`)=>{if(e)return null;let p=n();return p.start===a&&l.size===0?null:(t&&clearTimeout(t),setTimeout(()=>{let{newHeight:e,newLastMeasuredIndex:t,updatedHeightCache:n,clearedDirtyItems:a,newTotalHeight:c,newValidCount:m,heightChanges:h}=vi(r,p,i,o,l,u,d,f);(Math.abs(e-o)>1||l.size>0)&&s({newHeight:e,newLastMeasuredIndex:t,updatedHeightCache:n,clearedDirtyItems:a,newTotalHeight:c,newValidCount:m,heightChanges:h})},c))},xi=()=>{let e=!1,t=null;return n=>{t=n,e||(e=!0,requestAnimationFrame(()=>{e=!1,t&&=(t(),null)}))}},Si=(e,t,n,r=1)=>{let i=n[e];return i===void 0?!0:Math.abs(t-i)>r},Ci=(e,t,n,r)=>e?e.start!==t.start||e.end!==t.end||n!==r:!0,wi=(e,t,n,r,i,a,o)=>{let s=i<=1,c=i>=o-a-1;return{visibleItemsCount:e.end-e.start,startIndex:e.start,endIndex:e.end,totalItems:t,processedItems:n,averageItemHeight:r,atTop:s,atBottom:c,totalHeight:o}},Ti=e=>{let{mode:t,align:n,targetIndex:r,itemsLength:i,calculatedItemHeight:a,height:o,scrollTop:s,firstVisibleIndex:c,lastVisibleIndex:l,heightCache:u}=e;return t===`bottomToTop`?Ei({align:n,targetIndex:r,itemsLength:i,calculatedItemHeight:a,height:o,scrollTop:s,firstVisibleIndex:c,lastVisibleIndex:l,heightCache:u}):Di({align:n,targetIndex:r,calculatedItemHeight:a,height:o,scrollTop:s,firstVisibleIndex:c,lastVisibleIndex:l,heightCache:u})};var Ei=e=>{let{align:t,targetIndex:n,itemsLength:r,calculatedItemHeight:i,height:a,scrollTop:o,firstVisibleIndex:s,lastVisibleIndex:c,heightCache:l}=e,u=yi(l,i,r),d=yi(l,i,n),f=i;if(t===`auto`){if(n<s)return Math.max(0,u-(d+f));if(n>c-1)return Math.max(0,u-d-a);{let e=u-(d+f),t=u-d,n=Math.abs(o-e),r=Math.abs(o+a-t);return n<r?e:Math.max(0,t-a)}}else if(t===`top`)return Math.max(0,u-(d+f));else if(t===`bottom`)return Math.max(0,u-d-a);else if(t===`nearest`){let e=u-(d+f),t=u-d;if(t<=o||e>=o+a){let n=Math.abs(o-e),r=Math.abs(o+a-t);return n<r?e:Math.max(0,t-a)}else return null}return null},Di=e=>{let{align:t,targetIndex:n,calculatedItemHeight:r,height:i,scrollTop:a,firstVisibleIndex:o,lastVisibleIndex:s,heightCache:c}=e;if(t===`auto`){if(n<o)return yi(c,r,n);if(n>s-1){let e=yi(c,r,n+1);return Math.max(0,e-i)}else{let e=yi(c,r,n),t=yi(c,r,n+1),o=Math.abs(a-e),s=Math.abs(a+i-t);return o<s?e:Math.max(0,t-i)}}else if(t===`top`)return yi(c,r,n);else if(t===`bottom`){let e=yi(c,r,n+1);return Math.max(0,e-i)}else if(t===`nearest`){let e=yi(c,r,n),t=yi(c,r,n+1);if(t<=a||e>=a+i){let n=Math.abs(a-e),r=Math.abs(a+i-t);return n<r?e:Math.max(0,t-i)}else return null}return null};const Oi={now:()=>typeof performance<`u`&&performance.now?performance.now():Date.now()},ki=(e,t,n={})=>{let{leading:r=!0,trailing:i=!1}=n,a=0,o=null,s=null,c=!0,l=t=>{a=Oi.now(),e(...t)};return((...e)=>{let n=Oi.now(),u=c?t:n-a;if(s=e,o&&=(clearTimeout(o),null),u>=t)r&&(c=!1,l(e)),i&&!r&&(o=setTimeout(()=>{s&&l(s),o=null},t));else if(c&&r)c=!1,l(e);else if(i){let e=t-u;o=setTimeout(()=>{s&&l(s),o=null},e)}})};var Ai=Y(`<!> <div><!></div>`,1),ji=Y(`<div><div><div><div></div></div></div></div>`);function Mi(e,t){Ce(t,!0);let n=xi(),r=new WeakMap,i=typeof process<`u`&&({}?.PUBLIC_SVELTE_VIRTUAL_LIST_DEBUG===`true`||{}?.SVELTE_VIRTUAL_LIST_DEBUG===`true`),a=Xr(t,`items`,19,()=>[]),o=Xr(t,`defaultEstimatedItemHeight`,3,40),s=Xr(t,`debug`,3,!1),c=Xr(t,`mode`,3,`topToBottom`),l=Xr(t,`bufferSize`,3,20),u=_t([]),d=F(0),f=F(!1),p=F(-1),m=F(0),h=null,g=null,_=null,v=_t(new Set),y=F(0),b=F(0),x=F(null),S=F(0),C=F(0),ee=F(null),w=new Pi({itemLength:a().length,itemHeight:o(),internalDebug:i}),te=Math.random().toString(36).slice(2,7),T=(e,t)=>{if(!(!s()&&!i))try{let n=new Date().toISOString().split(`T`)[1]?.replace(`Z`,``);console.info(`[SVL][${te}] ${n} ${e}`,t??``)}catch{}},E=F(0),ne=P(()=>()=>{let e=q(k)();return(c()===`bottomToTop`?a().slice(e.start,e.end).reverse():a().slice(e.start,e.end)).map((t,n)=>({item:t,originalIndex:c()===`bottomToTop`?e.end-1-n:e.start+n,sliceIndex:n}))}),re=e=>{if(!w.viewportElement||!w.initialized||q(oe))return;if(c()===`bottomToTop`&&ue&&!q(se)&&performance.now()>=q(E)){let e=performance.now(),t=w.viewport,n=r.get(t)??0;if(e-n<16){I(E,e+50);return}r.set(t,e);let i=Math.max(0,q(D)()-q(d));T(`b2t-correction-approx`,{approximateScrollTop:i}),w.viewport.scrollTop=i,w.scrollTop=i,On().then(()=>{let e=w.viewport.querySelector(`[data-original-index="0"]`);if(e){let t=w.viewport.getBoundingClientRect(),n=e.getBoundingClientRect();Math.abs(t.y+t.height-(n.y+n.height))<=4||(e.scrollIntoView({block:`end`,behavior:`smooth`,inline:`nearest`}),T(`b2t-correction-native`,{containerBottom:t.y+t.height,itemBottom:n.y+n.height})),w.scrollTop=w.viewport.scrollTop,I(E,performance.now()+200)}});return}let t=w.viewport.scrollTop,n=Math.max(0,q(D)()-q(d)),i=0,a=q(k)();for(let t of e)t.index<a.start&&(i+=t.delta);if(Math.abs(i)>1){let e=Math.min(n,Math.max(0,t+i));w.viewport.scrollTop=e,w.scrollTop=e}},ie=ki(()=>{q(y)>0&&(ue=q(O),w.startDynamicUpdate(),ae())},16,{leading:!0,trailing:!0});Bt(()=>{ie()}),Bt(()=>{w.updateItemLength(a().length)});let ae=()=>{I(C,w.totalHeight,!0),h=bi(!1,h,q(k),u,w.getHeightCache(),q(p),w.averageHeight,e=>{if(w.itemHeight=e.newHeight,I(p,e.newLastMeasuredIndex,!0),e.heightChanges.length>0&&w.processDirtyHeights(e.heightChanges),e.heightChanges.length>0&&c()===`bottomToTop`){let t=e.heightChanges;queueMicrotask(()=>re(t))}if(c()===`topToBottom`&&w.isReady&&w.initialized){let e=q(C),t=w.totalHeight,n=t-e;if(Math.abs(n)>1){let e=Math.max(0,t-(q(d)||0)),r=Math.max(w.averageHeight,10),i=w.viewport.scrollTop;if(Math.abs(i-e)<=r){let t=Math.min(e,Math.max(0,i+n));w.viewport.scrollTop=t,w.scrollTop=t}}}An(()=>{v.clear(),I(y,0),ue=!1}),w.endDynamicUpdate()},q(p)<0?0:100,v,0,0,c())},oe=F(!1),se=F(!1),ce=F(0),le=F(0),D=P(()=>()=>w.totalHeight),O=P(()=>w.scrollTop>=q(D)()-q(d)-1),ue=!1,de=null;function fe(){if(!w.viewportElement)return;let e=w.viewport.querySelector(`[data-original-index="${a().length-1}"]`);if(!e)return;let t=w.viewport.getBoundingClientRect(),n=e.getBoundingClientRect();I(ee,Math.round(Math.abs(n.bottom-t.bottom)),!0),i&&console.info(`[SVL] bottomDistance(px):`,q(ee))}Bt(()=>{if(w.initialized&&c()===`bottomToTop`&&w.viewportElement){let e=Math.max(0,q(D)()-q(d)),t=w.viewport.scrollTop,n=Math.abs(t-e),r=Math.abs(w.averageHeight-q(ce))>1,i=Math.max(0,q(D)()-q(d)),a=Math.abs(t-i)<w.averageHeight;if(r&&!q(oe)&&!a&&!q(se)&&performance.now()>=q(E)&&!w.isDynamicUpdateInProgress&&n>w.averageHeight*3){let t=Math.round(e);w.viewport.scrollTop=t,w.scrollTop=t}n>w.averageHeight*5&&I(oe,!0),I(ce,w.averageHeight,!0)}}),Bt(()=>{let e=a().length;if(w.initialized&&c()===`bottomToTop`&&w.isReady&&q(le)>0&&e-q(le)!==0){let e=w.viewport.scrollTop,t=w.averageHeight,n=q(d),r=q(D)(),i=Math.max(0,r-n);(Math.abs(e-Math.max(0,q(le)*t-n))<t*2||e===0)&&w.runDynamicUpdate(()=>{let e=i;w.viewport.scrollTop=e,w.scrollTop=e,I(oe,!1)})}I(le,e,!0)}),Bt(()=>{if(w.isReady){let e=w.container.getBoundingClientRect().height;Number.isFinite(e)&&e>0&&I(d,e,!0)}}),Bt(()=>{if(q(d)===0&&w.isReady){let e=w.container.getBoundingClientRect().height;Number.isFinite(e)&&e>0&&I(b,e,!0)}});let k=P(()=>()=>{if(!a().length)return{start:0,end:0};let e=q(d)||0;if(c()===`bottomToTop`&&!w.initialized&&w.scrollTop===0&&e>0){let t=Math.max(0,q(D)()-e);return de=hi(t,e,w.averageHeight,a().length,l(),c(),q(O),ue,de,q(D)(),w.getHeightCache()),de}return de=hi(w.scrollTop,e,w.averageHeight,a().length,l(),c(),q(O),ue,de,q(D)(),w.getHeightCache()),de}),pe=()=>{w.viewportElement&&(q(f)||(I(f,!0),n(()=>{let e=w.viewport.scrollTop;if(c()===`bottomToTop`&&q(m)-e>.5&&(I(E,performance.now()+450),I(oe,!0)),I(m,e,!0),w.scrollTop=e,fe(),i){let e=q(k)();T(`scroll`,{mode:c(),scrollTop:w.scrollTop,height:q(d),totalHeight:q(D)(),averageItemHeight:w.averageHeight,visibleRange:e})}I(f,!1)})))},A=(e=!1)=>{if(T(`updateHeightAndScroll-enter`,{immediate:e,initialized:w.initialized,mode:c()}),!w.initialized&&c()===`bottomToTop`){On().then(()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{if(!w.isReady)return;let e=w.container.getBoundingClientRect().height;I(d,e,!0);let t=mi(a().length,w.averageHeight,e),n=String(te).toLowerCase().replace(/[^a-z0-9]/g,``).slice(-4),r=parseInt(n,36),i=Number.isNaN(r)?Math.floor(Math.random()*3):r%3;T(`b2t-init`,{measuredHeight:e,targetScrollTop:t,jitterMs:i}),setTimeout(()=>{w.viewport.scrollTop=t,w.scrollTop=t,requestAnimationFrame(()=>{w.initialized||=!0,On().then(()=>{let e=w.viewport.querySelector(`[data-original-index="0"]`);if(!e)return;let t=w.viewport.getBoundingClientRect(),n=e.getBoundingClientRect();Math.abs(t.y+t.height-(n.y+n.height))<=4||(e.scrollIntoView({block:`end`,inline:`nearest`}),w.scrollTop=w.viewport.scrollTop,T(`b2t-init-native-fallback`,{containerBottom:t.y+t.height,itemBottom:n.y+n.height}))})})},i)})})});return}_i({initialized:w.initialized,mode:c(),containerElement:w.containerElement,viewportElement:w.viewportElement,calculatedItemHeight:w.averageHeight,height:q(d),scrollTop:w.scrollTop},{setHeight:e=>I(d,e,!0),setScrollTop:e=>w.scrollTop=e,setInitialized:e=>{e&&w.initialized||(w.initialized=e)}},e),T(`updateHeightAndScroll-exit`,{immediate:e})};_=new ResizeObserver(e=>{n(()=>{T(`item-resize-observer`,{entries:e.length});let t=!1;q(k)();for(let n of e){let e=n.target,r=u.indexOf(e),i=parseInt(e.dataset.originalIndex||`-1`,10);if(r!==-1&&i>=0){let n=e.getBoundingClientRect().height;Si(i,n,w.getHeightCache())&&(q(y)===0&&(ue=q(O)),v.add(i),I(y,v.size,!0),t=!0)}}t&&(T(`item-resize-recalc`),ae())})}),Zr(()=>(T(`onMount-enter`,{mode:c(),items:a().length}),A(),On().then(()=>requestAnimationFrame(()=>requestAnimationFrame(()=>{T(`post-hydration-measure`),ae()}))),g=new ResizeObserver(()=>{if(!w.initialized){T(`container-resize-ignored`,`not-initialized`);return}T(`container-resize`),A(!0)}),w.isReady&&g.observe(w.container),()=>{g&&g.disconnect(),_&&_.disconnect()})),Bt(()=>{i&&(I(x,q(k)(),!0),I(S,w.averageHeight,!0))});let j=(e,t=!0,n=!0)=>{console.warn(`SvelteVirtualList: scrollToIndex is deprecated and will be removed in a future version. Use the new scroll method from the component instance instead.`),me({index:e,smoothScroll:t,shouldThrowOnBounds:n})},me=async e=>{let{index:t,smoothScroll:n,shouldThrowOnBounds:r,align:o}={...pi,...e};if(!a().length)return;if(!w.viewportElement){On().then(()=>{w.viewportElement&&me({index:t,smoothScroll:n,shouldThrowOnBounds:r,align:o})});return}let s=t;if(s<0||s>=a().length){if(r)throw Error(`scroll: index ${s} is out of bounds (0-${a().length-1})`);s=Math.max(0,Math.min(s,a().length-1))}let{start:l,end:u}=q(k)(),f=Ti({mode:c(),align:o||`auto`,targetIndex:s,itemsLength:a().length,calculatedItemHeight:w.averageHeight,height:q(d),scrollTop:w.scrollTop,firstVisibleIndex:l,lastVisibleIndex:u,heightCache:w.getHeightCache()});if(f!==null){if(I(se,!0),i&&w.viewportElement){let e=Math.max(0,w.viewport.scrollHeight-w.viewport.clientHeight);console.info(`[SVL] scroll-intent`,{targetIndex:s,align:o||`auto`,firstVisibleIndex:l,lastVisibleIndex:u,currentScrollTop:w.scrollTop,scrollTarget:f,domMaxScrollTop:e})}if(c()===`bottomToTop`&&n){let e=w.viewport.querySelectorAll(`[data-original-index]`),t=-1,n=null;for(let r of e){let e=parseInt(r.getAttribute(`data-original-index`)||`-1`);e>t&&(t=e,n=r)}n?.scrollIntoView({behavior:`smooth`}),await On(),await new Promise(e=>setTimeout(e,100)),await On()}w.viewport.scrollTo({top:f,behavior:n?`smooth`:`auto`}),requestAnimationFrame(()=>{if(w.scrollTop=f,i&&w.viewportElement){let e=Math.max(0,w.viewport.scrollHeight-w.viewport.clientHeight);console.info(`[SVL] scroll-after-call`,{scrollTop:w.scrollTop,domMaxScrollTop:e})}}),setTimeout(()=>{I(se,!1)},n?500:100)}};function he(e){return _&&_.observe(e),{destroy(){_&&_.unobserve(e)}}}var ge={scrollToIndex:j,scroll:me},_e=ji();Rr(_e,()=>({id:`virtual-list-container`,...t.testId?{"data-testid":`${t.testId}-container`}:{},class:t.containerClass??`virtual-list-container`}),void 0,void 0,`svelte-plopdb`);var ve=R(_e);Rr(ve,()=>({id:`virtual-list-viewport`,...t.testId?{"data-testid":`${t.testId}-viewport`}:{},class:t.viewportClass??`virtual-list-viewport`,onscroll:pe}),void 0,void 0,`svelte-plopdb`);var ye=R(ve);Rr(ye,e=>({id:`virtual-list-content`,...t.testId?{"data-testid":`${t.testId}-content`}:{},class:t.contentClass??`virtual-list-content`,[jr]:e}),[()=>({height:`${(()=>Math.max(q(d),q(D)()))()??``}px`})],void 0,`svelte-plopdb`);var be=R(ye);return Rr(be,e=>({id:`virtual-list-items`,...t.testId?{"data-testid":`${t.testId}-items`}:{},class:t.itemsClass??`virtual-list-items`,[jr]:e}),[()=>({visibility:q(d)===0&&c()===`bottomToTop`?`hidden`:`visible`,transform:`translateY(${(()=>{let e=q(d)||q(b)||0,t=q(k)(),n=e===0?400:e;return Math.round(gi(c(),a().length,t.end,t.start,w.averageHeight,n,q(D)(),w.getHeightCache(),q(b)))})()??``}px)`})],void 0,`svelte-plopdb`),sr(be,23,()=>q(ne)(),e=>e.originalIndex,(e,n,r)=>{var i=Ai(),o=Dt(i),c=e=>{let n=P(()=>wi(q(k)(),a().length,Object.keys(w.getHeightCache()).length,w.averageHeight,w.scrollTop,q(d)||0,q(D)()));var r=Zn();B(e=>Z(r,e),[()=>t.debugFunction?t.debugFunction(q(n)):console.info(`Virtual List Debug:`,q(n))]),X(e,r)};Q(o,e=>{s()&&q(r)===0&&Ci(q(x),q(k)(),q(S),w.averageHeight)&&e(c)});var l=z(o,2);Rr(l,()=>({"data-original-index":q(n).originalIndex,...t.testId?{"data-testid":`${t.testId}-item-${q(n).originalIndex}`}:{}}),void 0,void 0,`svelte-plopdb`);var f=R(l);pr(f,()=>t.renderItem,()=>q(n).item,()=>q(n).originalIndex),M(l),qr(l,(e,t)=>u[t.sliceIndex]=e,e=>u?.[e.sliceIndex],()=>[q(n)]),mr(l,e=>he?.(e)),X(e,i)}),M(be),M(ye),M(ve),qr(ve,e=>w.viewportElement=e,()=>w?.viewportElement),M(_e),qr(_e,e=>w.containerElement=e,()=>w?.containerElement),X(e,_e),we(ge)}var Ni=class{onRecompute;isScheduled=!1;isPending=!1;blockDepth=0;timeoutId=null;rafId=null;constructor(e){this.onRecompute=e}schedule=()=>{if(this.blockDepth>0){this.isPending=!0;return}if(!this.isScheduled){if(this.isScheduled=!0,!(typeof window<`u`&&typeof requestAnimationFrame==`function`)){this.timeoutId&&=(clearTimeout(this.timeoutId),null),this.timeoutId=setTimeout(()=>{this.timeoutId=null,this.isScheduled=!1,this.onRecompute()},0);return}this.rafId!==null&&cancelAnimationFrame(this.rafId),this.rafId=requestAnimationFrame(()=>{this.rafId=null,this.isScheduled=!1,this.onRecompute()})}};block=()=>{this.blockDepth+=1,this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null,this.isScheduled=!1,this.isPending=!0),this.rafId!==null&&(cancelAnimationFrame(this.rafId),this.rafId=null,this.isScheduled=!1,this.isPending=!0)};unblock=()=>{this.blockDepth!==0&&(--this.blockDepth,this.blockDepth===0&&this.isPending&&(this.isPending=!1,this.onRecompute()))};cancel=()=>{this.timeoutId&&=(clearTimeout(this.timeoutId),null),this.rafId!==null&&(cancelAnimationFrame(this.rafId),this.rafId=null),this.isScheduled=!1,this.isPending=!1}},Pi=class{#_totalMeasuredHeight=F(0);get _totalMeasuredHeight(){return q(this.#_totalMeasuredHeight)}set _totalMeasuredHeight(e){I(this.#_totalMeasuredHeight,e,!0)}#_measuredCount=F(0);get _measuredCount(){return q(this.#_measuredCount)}set _measuredCount(e){I(this.#_measuredCount,e,!0)}#_itemLength=F(0);get _itemLength(){return q(this.#_itemLength)}set _itemLength(e){I(this.#_itemLength,e,!0)}#_itemHeight=F(40);get _itemHeight(){return q(this.#_itemHeight)}set _itemHeight(e){I(this.#_itemHeight,e,!0)}#_averageHeight=F(40);get _averageHeight(){return q(this.#_averageHeight)}set _averageHeight(e){I(this.#_averageHeight,e,!0)}#_totalHeight=F(0);get _totalHeight(){return q(this.#_totalHeight)}set _totalHeight(e){I(this.#_totalHeight,e,!0)}_measuredFlags=null;#_initialized=F(!1);get _initialized(){return q(this.#_initialized)}set _initialized(e){I(this.#_initialized,e,!0)}#_scrollTop=F(0);get _scrollTop(){return q(this.#_scrollTop)}set _scrollTop(e){I(this.#_scrollTop,e,!0)}#_containerElement=F(null);get _containerElement(){return q(this.#_containerElement)}set _containerElement(e){I(this.#_containerElement,e,!0)}#_viewportElement=F(null);get _viewportElement(){return q(this.#_viewportElement)}set _viewportElement(e){I(this.#_viewportElement,e,!0)}_internalDebug=!1;#_isReady=F(!1);get _isReady(){return q(this.#_isReady)}set _isReady(e){I(this.#_isReady,e,!0)}#_dynamicUpdateInProgress=F(!1);get _dynamicUpdateInProgress(){return q(this.#_dynamicUpdateInProgress)}set _dynamicUpdateInProgress(e){I(this.#_dynamicUpdateInProgress,e,!0)}#_dynamicUpdateDepth=F(0);get _dynamicUpdateDepth(){return q(this.#_dynamicUpdateDepth)}set _dynamicUpdateDepth(e){I(this.#_dynamicUpdateDepth,e,!0)}#_itemsWrapperElement=F(null);get _itemsWrapperElement(){return q(this.#_itemsWrapperElement)}set _itemsWrapperElement(e){I(this.#_itemsWrapperElement,e,!0)}#_gridDetected=F(!1);get _gridDetected(){return q(this.#_gridDetected)}set _gridDetected(e){I(this.#_gridDetected,e,!0)}#_gridColumns=F(1);get _gridColumns(){return q(this.#_gridColumns)}set _gridColumns(e){I(this.#_gridColumns,e,!0)}_gridObserver=null;_mutationObserver=null;_heightCache={};_scheduler=new Ni(()=>this.recomputeDerivedHeights());recomputeDerivedHeights(){let e=this._measuredCount>0?this._totalMeasuredHeight/this._measuredCount:this._itemHeight;this._averageHeight=e;let t=this._itemLength-this._measuredCount;this._totalHeight=this._totalMeasuredHeight+t*e}recomputeIsReady(){this._isReady=!!this._containerElement&&!!this._viewportElement}scheduleRecomputeDerivedHeights(){let e=typeof navigator<`u`&&typeof navigator.userAgent==`string`?/jsdom/i.test(navigator.userAgent):!1;if(typeof window>`u`||e){this.recomputeDerivedHeights();return}if(this._dynamicUpdateDepth>0){this._scheduler.block();return}this._scheduler.schedule()}get totalMeasuredHeight(){return this._totalMeasuredHeight}get measuredCount(){return this._measuredCount}get itemLength(){return this._itemLength}get itemHeight(){return this._itemHeight}set itemHeight(e){this._itemHeight=e,this.scheduleRecomputeDerivedHeights()}get initialized(){return this._initialized}set initialized(e){if(this._initialized)throw Error(`ReactiveListManager: initialized flag cannot be set to true after it has been set to true`);this._initialized=e}get scrollTop(){return this._scrollTop}set scrollTop(e){this._internalDebug&&this.#debugCheckScrollTopRepeat(e),this._scrollTop=e}get containerElement(){return this._containerElement}get container(){if(!this._isReady)throw Error(`ReactiveListManager: container is not ready`);return this._containerElement}set containerElement(e){this._containerElement=e,this.recomputeIsReady()}get viewportElement(){return this._viewportElement}get viewport(){if(!this._isReady)throw Error(`ReactiveListManager: viewport is not ready`);return this._viewportElement}set viewportElement(e){this._viewportElement=e,this.recomputeIsReady()}get itemsWrapperElement(){return this._itemsWrapperElement}set itemsWrapperElement(e){if(this._itemsWrapperElement!==e){if(this._gridObserver){try{this._gridObserver.disconnect()}catch{}this._gridObserver=null}if(this._mutationObserver){try{this._mutationObserver.disconnect()}catch{}this._mutationObserver=null}}if(this._itemsWrapperElement=e,!e){this._gridDetected=!1,this._gridColumns=1;return}this.#attachGridObserver(),this.#attachMutationObserver(),this.#detectGridColumns()}get gridDetected(){return this._gridDetected}get gridColumns(){return this._gridColumns}get isReady(){return this._isReady}get isDynamicUpdateInProgress(){return this._dynamicUpdateDepth>0}startDynamicUpdate(){let e=this._dynamicUpdateDepth===0;this._dynamicUpdateDepth+=1,e&&(this._dynamicUpdateInProgress=!0,this._isReady&&this._viewportElement&&this._viewportElement.style.setProperty(`overflow-anchor`,`none`))}endDynamicUpdate(){this._dynamicUpdateDepth<=0||(--this._dynamicUpdateDepth,this._dynamicUpdateDepth===0&&(this._isReady&&this._viewportElement&&this._viewportElement.style.setProperty(`overflow-anchor`,`auto`),this._dynamicUpdateInProgress=!1,this._scheduler.unblock()))}async runDynamicUpdate(e){this.startDynamicUpdate();try{let t=e();return t instanceof Promise?await t:t}finally{this.endDynamicUpdate()}}#debugLastScrollValue=null;#debugWindowStartMs=0;#debugRepeatCount=0;#debugWarnedThisWindow=!1;#debugCheckScrollTopRepeat(e){let t=typeof performance<`u`&&performance.now?performance.now():Date.now();this.#debugLastScrollValue===e?t-this.#debugWindowStartMs<=1e3?(this.#debugRepeatCount+=1,this.#debugRepeatCount>10&&!this.#debugWarnedThisWindow&&(this.#debugWarnedThisWindow=!0,console.warn(`
================ SvelteVirtualList DEBUG ================
scrollTop assigned same value ${e} > 10 times within 1s\ncount=${this.#debugRepeatCount}, windowStart=${Math.round(this.#debugWindowStartMs)}ms\nThis may indicate redundant updates or feedback loops.
========================================================
`))):(this.#debugWindowStartMs=t,this.#debugRepeatCount=1,this.#debugWarnedThisWindow=!1):(this.#debugLastScrollValue=e,this.#debugWindowStartMs=t,this.#debugRepeatCount=1,this.#debugWarnedThisWindow=!1)}get averageHeight(){return this._averageHeight}get totalHeight(){return this._totalHeight}flushRecompute=()=>{this.recomputeDerivedHeights()};getHeightCache(){return this._heightCache}constructor(e){this._itemLength=e.itemLength,this._itemHeight=e.itemHeight,this._internalDebug=e.internalDebug??!1,this._measuredFlags=new Uint8Array(Math.max(0,this._itemLength)),this.recomputeDerivedHeights()}processDirtyHeights(e){if(e.length===0)return;let t=0,n=0;for(let r of e){let{index:e,oldHeight:i,newHeight:a}=r;i!==void 0&&(t-=i,--n),a===void 0?delete this._heightCache[e]:(t+=a,n+=1,this._heightCache[e]=a),this._measuredFlags&&e>=0&&e<this._measuredFlags.length&&(this._measuredFlags[e]=1)}let r=typeof navigator<`u`&&typeof navigator.userAgent==`string`?/jsdom/i.test(navigator.userAgent):!1;if(typeof window>`u`||r){if(t===0&&n===0)return}else if(n===0)return;this._totalMeasuredHeight+=t,this._measuredCount+=n,this.scheduleRecomputeDerivedHeights()}updateItemLength(e){this._itemLength=e,this._measuredFlags=new Uint8Array(Math.max(0,e)),this.recomputeDerivedHeights()}updateEstimatedHeight(e){this._itemHeight=e,this.scheduleRecomputeDerivedHeights()}setMeasuredHeight(e,t){if(e<0||e>=this._itemLength)return;let n=this._heightCache[e];Number.isFinite(n)&&n>0?this._totalMeasuredHeight-=n:this._measuredCount+=1,Number.isFinite(t)&&t>0&&(this._heightCache[e]=t,this._totalMeasuredHeight+=t,this.scheduleRecomputeDerivedHeights())}reset(){this._totalMeasuredHeight=0,this._measuredCount=0,this._measuredFlags=this._itemLength>0?new Uint8Array(this._itemLength):null,this.scheduleRecomputeDerivedHeights()}getDebugInfo(){return{totalMeasuredHeight:this._totalMeasuredHeight,measuredCount:this._measuredCount,itemLength:this._itemLength,coveragePercent:this._itemLength>0?this._measuredCount/this._itemLength*100:0,itemHeight:this._itemHeight,averageHeight:this.averageHeight,totalHeight:this.totalHeight,gridDetected:this._gridDetected,gridColumns:this._gridColumns}}getMeasurementCoverage(){return this.getDebugInfo().coveragePercent}hasSufficientMeasurements(e=10){return this.getMeasurementCoverage()>=e}recomputeGridDetection(){this.#detectGridColumns()}#attachGridObserver(){let e=this._itemsWrapperElement;if(!(typeof window>`u`||!e))try{this._gridObserver=new ResizeObserver(()=>{this.#detectGridColumns()}),this._gridObserver.observe(e)}catch{this._gridObserver=null}}#attachMutationObserver(){let e=this._itemsWrapperElement;if(!(typeof window>`u`||!e))try{this._mutationObserver=new MutationObserver(e=>{for(let t of e)if(t.type===`attributes`&&(t.attributeName===`class`||t.attributeName===`style`)){this.#detectGridColumns();break}}),this._mutationObserver.observe(e,{attributes:!0,attributeFilter:[`class`,`style`]})}catch{this._mutationObserver=null}}#detectGridColumns(){let e=this._itemsWrapperElement;if(!e){this._gridDetected=!1,this._gridColumns=1;return}let t=!1,n=1;try{let r=getComputedStyle(e);if(r.display===`grid`){let e=r.gridTemplateColumns,i=/repeat\(\s*(\d+)\s*,/i.exec(e);if(i&&i[1])n=Math.max(1,parseInt(i[1],10)),t=!0;else if(e&&e!==`none`){let r=this.#countTracksFromTemplate(e);Number.isFinite(r)&&r>0&&(n=r,t=!0)}}}catch{}if(!t){let r=e.children;if(r&&r.length>0){let e=r[0].getBoundingClientRect().top,i=0;for(let t=0;t<r.length;t+=1){let n=r[t].getBoundingClientRect().top;if(Math.abs(n-e)<=1)i+=1;else break}i>0&&(n=i,t=i>1)}}this._gridDetected=t,this._gridColumns=Math.max(1,n),this._internalDebug&&console.info(`[ReactiveListManager] grid detection:`,{detected:this._gridDetected,columns:this._gridColumns})}#countTracksFromTemplate(e){let t=0,n=0,r=!1;for(let i=0;i<e.length;i+=1){let a=e[i];a===`(`?t+=1:a===`)`&&(t=Math.max(0,t-1)),t===0&&/\s/.test(a)?r&&=(n+=1,!1):a!==` `&&(r=!0)}return r&&(n+=1),n}},Fi=Mi,Ii={ActorControlType:{0:`ToggleWeapon`,1:`AutoAttack`,2:`SetStatus`,3:`CastStart`,4:`ToggleAggro`,5:`ClassJobChange`,6:`DefeatMsg`,7:`GainExpMsg`,9:`ClassJobUpdate`,10:`LevelUpEffect`,12:`ExpChainMsg`,13:`HpSetStat`,14:`DeathAnimation`,15:`CastInterrupt`,17:`ActionStart`,20:`StatusEffectGain`,21:`StatusEffectLose`,23:`HPFloatingText`,24:`UpdateRestedExp`,25:`Unk2`,27:`Flee`,32:`Unk3`,34:`CombatIndicationShow`,37:`SpawnEffect`,38:`ToggleInvisible`,41:`ToggleActionUnlock`,43:`UpdateUiExp`,45:`DmgTakenMsg`,50:`SetTarget`,54:`ToggleNameHidden`,71:`LimitbreakStart`,72:`LimitbreakPartyStart`,73:`BubbleText`,80:`DamageEffect`,81:`RaiseAnimation`,87:`TreasureScreenMsg`,89:`SetOwnerId`,92:`ItemRepairMsg`,99:`BluActionLearn`,100:`DirectorInit`,101:`DirectorClear`,102:`LeveStartAnim`,103:`LeveStartError`,106:`DirectorEObjMod`,109:`DirectorUpdate`,117:`ItemObtainMsg`,123:`DutyQuestScreenMsg`,132:`ItemObtainIcon`,133:`FateItemFailMsg`,134:`ItemFailMsg`,135:`ActionLearnMsg1`,138:`FreeEventPos`,144:`DailyQuestSeed`,161:`SetBGM`,164:`UnlockAetherCurrentMsg`,168:`RemoveName`,170:`ScreenFadeOut`,185:`CeremonyDecoration`,200:`ZoneIn`,201:`ZoneInDefaultPos`,203:`TeleportStart`,205:`TeleportDone`,206:`TeleportDoneFadeOut`,207:`DespawnZoneScreenMsg`,210:`InstanceSelectDlg`,212:`ActorDespawnEffect`,253:`CompanionUnlock`,254:`ObtainBarding`,255:`EquipBarding`,258:`CompanionMsg1`,259:`CompanionMsg2`,260:`ShowPetHotbar`,265:`ActionLearnMsg`,266:`ActorFadeOut`,267:`ActorFadeIn`,268:`WithdrawMsg`,269:`OrderCompanion`,270:`ToggleCompanion`,271:`LearnCompanion`,272:`ActorFateOut1`,290:`Emote`,291:`EmoteInterrupt`,295:`SetPose`,300:`CraftingUnk`,304:`GatheringSenseMsg`,305:`PartyMsg`,306:`GatheringSenseMsg1`,312:`GatheringSenseMsg2`,320:`FishingMsg`,322:`FishingTotalFishCaught`,325:`FishingBaitMsg`,327:`FishingReachMsg`,328:`FishingFailMsg`,350:`MateriaConvertMsg`,351:`MeldSuccessMsg`,352:`MeldFailMsg`,353:`MeldModeToggle`,355:`AetherRestoreMsg`,360:`DyeMsg`,362:`ToggleCrestMsg`,363:`ToggleBulkCrestMsg`,364:`MateriaRemoveMsg`,365:`GlamourCastMsg`,366:`GlamourRemoveMsg`,377:`RelicInfuseMsg`,381:`AetherReductionDlg`,409:`EObjSetState`,412:`Unk6`,413:`EObjAnimation`,500:`SetTitle`,504:`SetStatusIcon`,505:`LimitBreakGauge`,507:`SetHomepoint`,508:`SetFavorite`,509:`LearnTeleport`,511:`BeginMapUpdate`,512:`FinishMapUpdate`,513:`ArmoryErrorMsg`,515:`AchievementPopup`,517:`LogMsg`,518:`AchievementMsg`,521:`SetItemLevel`,523:`ChallengeEntryCompleteMsg`,524:`ChallengeEntryUnlockMsg`,527:`DesynthOrReductionResult`,529:`GilTrailMsg`,541:`HuntingLogRankUnlock`,542:`HuntingLogEntryUpdate`,543:`HuntingLogSectionFinish`,544:`HuntingLogRankFinish`,608:`SetCharaGearParamUI`,609:`ToggleWireframeRendering`,703:`ExamineError`,800:`SetMaxGearSets`,801:`GearSetEquipMsg`,805:`SetBait`,902:`SetFestival`,903:`SetMountBitmask`,918:`ToggleOrchestrionUnlock`,925:`EventBattleDialog`,928:`SetMountSpeed`,930:`BeginReplayAck`,931:`EndReplayAck`,1001:`ShowBuildPresetUI`,1002:`ShowEstateExternalAppearanceUI`,1003:`ShowEstateInternalAppearanceUI`,1005:`BuildPresetResponse`,1007:`RemoveExteriorHousingItem`,1009:`RemoveInteriorHousingItem`,1015:`ShowHousingItemUI`,1017:`HousingItemMoveConfirm`,1023:`OpenEstateSettingsUI`,1024:`HideAdditionalChambersDoor`,1049:`HousingStoreroomStatus`,1504:`SetPvPState`,1505:`EndDuelSession`,1506:`StartDuelCountdown`,1507:`StartDuel`,1508:`DuelResultScreen`,1512:`SetDutyActionId`,1513:`SetDutyActionHud`,1514:`SetDutyActionActive`,1515:`SetDutyActionRemaining`,1850:`EurekaStep`},ClientTriggerType:{1:`ToggleSheathe`,2:`ToggleAutoAttack`,3:`ChangeTarget`,101:`DismountReq`,102:`SpawnCompanionReq`,103:`DespawnCompanionReq`,104:`RemoveStatusEffect`,105:`CastCancel`,200:`Return`,201:`FinishZoning`,202:`Teleport`,300:`Examine`,301:`MarkPlayer`,302:`SetTitleReq`,303:`TitleList`,306:`UpdatedSeenHowTos`,308:`CutscenePlayed`,309:`AllotAttribute`,314:`CameraMode`,317:`CharaNameReq`,404:`HuntingLogDetails`,427:`Timers`,433:`DyeItem`,452:`RequestChocoboInventory`,500:`EmoteReq`,501:`EmoteWithWarp`,502:`EmoteCancel`,503:`PersistentEmoteCancel`,504:`EmoteCancelWithWarp`,505:`PoseChange`,506:`PoseReapply`,507:`PoseCancel`,514:`AchievementCrit`,515:`AchievementComp`,518:`AchievementCatChat`,701:`Fishing`,702:`QuestJournalUpdateQuestVisibility`,703:`QuestJournalClosed`,800:`AbandonQuest`,801:`DirectorInitFinish`,808:`DirectorSync`,816:`EnterTerritoryEventFinished`,819:`RequestInstanceLeave`,1e3:`AchievementCritReq`,1001:`AchievementList`,1035:`SetEstateLightingLevel`,1100:`RequestHousingBuildPreset`,1101:`RequestEstateExteriorRemodel`,1102:`RequestEstateInteriorRemodel`,1103:`RequestEstateHallRemoval`,1104:`RequestBuildPreset`,1105:`RequestLandSignFree`,1106:`RequestLandSignOwned`,1107:`RequestWardLandInfo`,1108:`RequestLandRelinquish`,1112:`RequestLandInventory`,1113:`RequestHousingItemRemove`,1114:`RequestEstateRename`,1115:`RequestEstateEditGreeting`,1116:`RequestEstateGreeting`,1117:`RequestEstateEditGuestAccessSettings`,1118:`UpdateEstateGuestAccess`,1119:`RequestEstateTagSettings`,1121:`RequestEstateInventory`,1123:`RequestHousingItemUI`,1135:`RequestSharedEstateSettings`,1137:`UpdateEstateLightingLevel`,1150:`HousingItemSelectedInUI`,1700:`CompanionAction`,1701:`CompanionSetBarding`,1702:`CompanionActionUnlock`,1820:`OpenPerformInstrumentUI`,1980:`StartReplay`,1981:`EndReplay`,2200:`OpenDuelUI`,2201:`DuelRequestResult`,9004:`RequestEventBattle`}},Li={CFPreferredRole:`CFPlayerInNeed`};URLSearchParams,Symbol.iterator;function Ri(e,t){return e.toString(16).padStart(t,`0`)}function zi(e,t,n=0){if(n===0){let r=t;for(;r<e.byteLength&&e.getUint8(r)!==0;r++);n=r-t}let r=new TextDecoder,i=new Uint8Array(e.buffer,e.byteOffset+t,n);return r.decode(i)}function Bi(e){return new Date(e).toLocaleTimeString()}function Vi(e){return Array.from(e).map(e=>e.toString(16).padStart(2,`0`)).join(` `)}var Hi=class{constructor(e,t,n=[]){let r=new Map;for(let e of n)for(let t=0;t<Math.min(e.old.length,e.new.length);t++){let n=e.old[t],i=e.new[t];(typeof n==`string`||typeof i==`string`)&&r.set(parseInt(n),parseInt(i)),typeof n==`number`&&typeof i==`number`&&r.set(n,i)}for(let n of t)if(n.region===e){this.opcodeClientName=new Map,this.opcodeServName=new Map;for(let e of n.lists.ClientZoneIpcType){let t=r.get(e.opcode)??e.opcode;this.opcodeClientName.set(t,e.name)}for(let e of n.lists.ServerZoneIpcType){let t=r.get(e.opcode)??e.opcode;this.opcodeServName.set(t,e.name)}return}throw Error(`Opcode list for region ${e} not found`)}getOpcodeName(e,t){return t?this.opcodeClientName.get(e)||void 0:this.opcodeServName.get(e)||void 0}getNameOpcode(e){for(let[t,n]of this.opcodeClientName.entries())if(n.localeCompare(e,void 0,{sensitivity:`base`})===0)return t;for(let[t,n]of this.opcodeServName.entries())if(n.localeCompare(e,void 0,{sensitivity:`base`})===0)return t}},Ui=Ii,Wi={"FFXIVIpcActorControl.category":`ActorControlType`,"FFXIVIpcActorControlSelf.category":`ActorControlType`,"FFXIVIpcActorControlTarget.category":`ActorControlType`,"FFXIVIpcClientTrigger.commandId":`ClientTriggerType`,"FFXIVIpcItemInfo.catalogId":`ItemId`,"FFXIVIpcCurrencyCrystalInfo.catalogId":`ItemId`,"FFXIVIpcInventoryTransaction.catalogId":`ItemId`,"FFXIVIpcInventoryTransaction.targetCatalogId":`ItemId`,"FFXIVIpcUpdateInventorySlot.catalogId":`ItemId`,"FFXIVIpcUpdateInventorySlot.glamourCatalogId":`ItemId`,"MarketBoardRequestItemListings.itemCatalogId":`ItemId`,"MarketBoardRequestItemListingInfo.catalogId":`ItemId`,"FFFXIVIpcMarketBoardItemListingCount.catalogId":`ItemId`,"FFXIVIpcMarketBoardItemListingHistory.itemCatalogId":`ItemId`,"FFXIVIpcMarketBoardItemListingHistory.itemCatalogId2":`ItemId`,"MarketListing.itemCatalogId":`ItemId`,"MarketBoardSearchResult.itemCatalogId":`ItemId`,"FFXIVIpcExamine.catalogId":`ItemId`,"FFXIVIpcExamine.appearanceCatalogId":`ItemId`,"FFXIVIpcPlayerSetup.useBaitCatalogId":`ItemId`,"FFXIVIpcActorControlSelf.FishingMsg.param1":`ItemId`,"FFXIVIpcActorControlSelf.FishingBaitMsg.param1":`ItemId`,"FFXIVIpcSystemLogMessage.messageId":`LogMessage`,"FFXIVIpcActorControl.LogMsg.param1":`LogMessage`,"FFXIVIpcActorControlSelf.LogMsg.param1":`LogMessage`,"FFXIVIpcActorControlTarget.LogMsg.param1":`LogMessage`,"FFXIVIpcUpdateClassInfo.classId":`ClassJob`,"FFXIVIpcPlayerClassInfo.classId":`ClassJob`,"PartyMember.classId":`ClassJob`,"FFXIVIpcMarketBoardSearch.classJobId":`ClassJob`,"FFXIVIpcModelEquip.classJobId":`ClassJob`,"FFXIVIpcActorGauge.classJobId":`ClassJob`,"FFXIVIpcDuelChallenge.otherClassJobId":`ClassJob`,"StatusEffect.effect_id":`Status`,"FFXIVIpcActorControl.StatusEffectGain.param1":`Status`,"FFXIVIpcActorControlSelf.StatusEffectGain.param1":`Status`,"FFXIVIpcActorControlTarget.StatusEffectGain.param1":`Status`,"FFXIVIpcActorControl.StatusEffectLose.param1":`Status`,"FFXIVIpcActorControlSelf.StatusEffectLose.param1":`Status`,"FFXIVIpcActorControlTarget.StatusEffectLose.param1":`Status`},Gi={FFXIVIpcActorControl:`category`,FFXIVIpcActorControlSelf:`category`,FFXIVIpcActorControlTarget:`category`,FFXIVIpcClientTrigger:`commandId`},Ki=class{constructor(e){this.nameDatabase=e}fieldHasAlias(e,t,n=``,r=0){if(n){let i=e+`.`+n,a=this.getAliasValue(i,r);if(a){let n=e+`.`+a+`.`+t;if(Wi[n])return!0}}switch(t){case`actionId`:return!0}let i=e+`.`+t;return!!Wi[i]}getFieldAlias(e,t,n,r=``,i=0){if(r){let a=e+`.`+r,o=this.getAliasValue(a,i);if(o){let r=e+`.`+o+`.`+t,i=this.getAliasValue(r,n);if(i!==null)return i;console.log(`Alias not found for key: ${r} value: ${n}`)}}switch(t){case`actionId`:return this.nameDatabase.Action[n]}let a=e+`.`+t;return this.getAliasValue(a,n)}getAliasValue(e,t){switch(Wi[e]||e){case`ActorControlType`:return Ui.ActorControlType[t];case`ClientTriggerType`:return Ui.ClientTriggerType[t];case`LogMessage`:return this.nameDatabase.LogMessage[t];case`ItemId`:return this.nameDatabase.Item[t];case`ClassJob`:return this.nameDatabase.ClassJob[t];case`Status`:return this.nameDatabase.Status[t]}return null}};function qi(e){return Gi[e]||``}var Ji=Li,Yi=class{#subscribe;constructor(){this.versions=new Map,this.currentVer=``,this.opcode=null,this.name=null,this.ipc=null,this.update=()=>{},this.#subscribe=Ze(e=>{this.update=e})}get versionList(){return this.#subscribe(),Array.from(this.versions.keys()).sort()}get version(){return this.#subscribe(),this.currentVer}async loadVersions(){let e=await(await fetch(`/data/version.json`)).json();for(let t of e)this.versions.set(t.version,t);this.update()}async loadVersion(e){let t=this.versions.get(e);if(!t)throw Error(`Version ${e} not found`);let n=t.version,r=n,i=[];if(t.based_on){if(t.opcode_diff){let e=await fetch(`/data/${n}/opcode.diff.json`);i.push(...await e.json()),r=t.based_on}n=t.based_on}let a=await(await fetch(`/data/${r}/opcode.json`)).json();this.opcode=new Hi(`CN`,a,i);let o=await(await fetch(`/data/${n}/db.json`)).json();this.name=new Ki(o),this.ipc=await(await fetch(`/data/${n}/ipc_structs.json`)).json(),this.currentVer=e,this.update()}getIpcStruct(e){if(!this.ipc||!e)return null;let t=Ji[e]||e;return this.ipc.structs.find(e=>e.name===t||e.name===`FFXIVIpc`+t)||null}getEnumValue(e,t){if(!this.ipc)return null;let n=this.ipc.enums.find(t=>t.name===e);return n&&n.enum[t]||null}getOpcodeName(e,t){if(this.#subscribe(),this.opcode)return this.opcode.getOpcodeName(e,t)}getNameOpcode(e){if(this.opcode)return this.opcode.getNameOpcode(e)}fieldHasAlias(e,t,n=``,r=0){return this.name?this.name.fieldHasAlias(e,t,n,r):!1}getFieldAlias(e,t,n,r=``,i=0){return this.name?this.name.getFieldAlias(e,t,n,r,i):null}},Xi=Y(`<li class="svelte-toqhbe"><span class="inspect-name svelte-toqhbe">uint16</span> </li> <li class="svelte-toqhbe"><span class="inspect-name svelte-toqhbe">int16</span> </li>`,1),Zi=Y(`<li class="svelte-toqhbe"><span class="inspect-name svelte-toqhbe">uint32</span> </li> <li class="svelte-toqhbe"><span class="inspect-name svelte-toqhbe">int32</span> </li>`,1),Qi=Y(`<li class="svelte-toqhbe"><span class="inspect-name svelte-toqhbe">uint64</span> </li> <li class="svelte-toqhbe"><span class="inspect-name svelte-toqhbe">int64</span> </li>`,1),$i=Y(`<li class="svelte-toqhbe"><span class="inspect-name svelte-toqhbe">float32</span> </li>`),ea=Y(`<li class="svelte-toqhbe"><span class="inspect-name svelte-toqhbe">float64</span> </li>`),ta=Y(`<li class="svelte-toqhbe"><span class="inspect-name svelte-toqhbe">time</span> </li>`),na=Y(`<ul class="svelte-toqhbe"><li class="svelte-toqhbe"><span class="inspect-name svelte-toqhbe">offset</span> </li> <li class="svelte-toqhbe"><span class="inspect-name svelte-toqhbe">uint8</span> </li> <li class="svelte-toqhbe"><span class="inspect-name svelte-toqhbe">int8</span> </li> <!> <!> <!> <!> <!> <!> <li class="svelte-toqhbe"><span class="inspect-name svelte-toqhbe">string</span> </li></ul>`),ra=Y(`<div class="packet-inspect svelte-toqhbe"><!></div>`);function ia(e,t){Ce(t,!0);function n(e){return new Date(e).toISOString()}var r=ra(),i=R(r),a=e=>{var r=na(),i=R(r),a=z(R(i));M(i);var o=z(i,2),s=z(R(o));M(o);var c=z(o,2),l=z(R(c));M(c);var u=z(c,2),d=e=>{var n=Xi(),r=Dt(n),i=z(R(r));M(r);var a=z(r,2),o=z(R(a));M(a),B((e,t)=>{Z(i,` ${e??``}`),Z(o,` ${t??``}`)},[()=>t.dw.getUint16(t.selectedIndex,!0),()=>t.dw.getInt16(t.selectedIndex,!0)]),X(e,n)};Q(u,e=>{t.selectedIndex+1<t.dw.byteLength&&e(d)});var f=z(u,2),p=e=>{var n=Zi(),r=Dt(n),i=z(R(r));M(r);var a=z(r,2),o=z(R(a));M(a),B((e,t)=>{Z(i,` ${e??``}`),Z(o,` ${t??``}`)},[()=>t.dw.getUint32(t.selectedIndex,!0),()=>t.dw.getInt32(t.selectedIndex,!0)]),X(e,n)};Q(f,e=>{t.selectedIndex+3<t.dw.byteLength&&e(p)});var m=z(f,2),h=e=>{var n=Qi(),r=Dt(n),i=z(R(r));M(r);var a=z(r,2),o=z(R(a));M(a),B((e,t)=>{Z(i,` ${e??``}`),Z(o,` ${t??``}`)},[()=>t.dw.getBigUint64(t.selectedIndex,!0),()=>t.dw.getBigInt64(t.selectedIndex,!0)]),X(e,n)};Q(m,e=>{t.selectedIndex+7<t.dw.byteLength&&e(h)});var g=z(m,2),_=e=>{var n=$i(),r=z(R(n));M(n),B(e=>Z(r,` ${e??``}`),[()=>t.dw.getFloat32(t.selectedIndex,!0)]),X(e,n)};Q(g,e=>{t.selectedIndex+3<t.dw.byteLength&&e(_)});var v=z(g,2),y=e=>{var n=ea(),r=z(R(n));M(n),B(e=>Z(r,` ${e??``}`),[()=>t.dw.getFloat64(t.selectedIndex,!0)]),X(e,n)};Q(v,e=>{t.selectedIndex+7<t.dw.byteLength&&e(y)});var b=z(v,2),x=e=>{var r=ta(),i=z(R(r));M(r),B(e=>Z(i,` ${e??``}`),[()=>n(t.dw.getUint32(t.selectedIndex,!0)*1e3)]),X(e,r)};Q(b,e=>{t.selectedIndex+3<t.dw.byteLength&&e(x)});var S=z(b,2),C=z(R(S));M(S),M(r),B((e,n,r,i)=>{Z(a,` ${t.selectedIndex??``} (${e??``}h, ${t.selectedIndex-32} without header)`),Z(s,` ${n??``}`),Z(l,` ${r??``}`),Z(C,` ${i??``}`)},[()=>Ri(t.selectedIndex,2),()=>t.dw.getUint8(t.selectedIndex),()=>t.dw.getInt8(t.selectedIndex),()=>zi(t.dw,t.selectedIndex)]),X(e,r)};Q(i,e=>{t.selectedIndex>=0&&t.selectedIndex<t.dw.byteLength&&e(a)}),M(r),X(e,r),we()}var aa=Y(`<span> </span>`),oa=Y(`<span> </span>`),sa=Y(`<span> </span>`),ca=Y(`<span> </span>`),la=Y(`<span> </span>`),ua=Y(`<div class="field-alias svelte-ehm4pt"> </div>`),da=Y(`<div class="field-value svelte-ehm4pt"><!></div> <!>`,1),fa=Y(`<div class="field-values"></div>`),pa=Y(`<div class="field-item svelte-ehm4pt"><div class="field-name svelte-ehm4pt"> </div> <!></div>`);function ma(e,t){Ce(t,!0);function n(e){switch(t.field.type){case`uint8`:return t.dw.getUint8(t.offset+e);case`int8`:return t.dw.getInt8(t.offset+e);case`uint16`:return t.dw.getUint16(t.offset+e*2,!0);case`int16`:return t.dw.getInt16(t.offset+e*2,!0);case`uint32`:return t.dw.getUint32(t.offset+e*4,!0);case`int32`:return t.dw.getInt32(t.offset+e*4,!0);case`uint64`:return t.dw.getBigUint64(t.offset+e*4,!0);case`int64`:return t.dw.getBigInt64(t.offset+e*4,!0);case`float`:return t.dw.getFloat32(t.offset+e*4,!0);case`double`:return t.dw.getFloat64(t.offset+e*8,!0)}}function r(e){switch(t.field.size){case 1:return t.dw.getUint8(t.offset+e);case 2:return t.dw.getUint16(t.offset+e*2,!0);case 4:return t.dw.getUint32(t.offset+e*4,!0)}}function i(e){let n=r(e),i=t.repo.getEnumValue(t.field.type,n);return i===null?n?.toString():i+` (${n})`}var a=pa(),o=R(a),s=R(o);M(o);var c=z(o,2),l=e=>{var n=Qn(),r=Dt(n),i=e=>{var n=aa(),r=R(n,!0);M(n),B(e=>Z(r,e),[()=>zi(t.dw,t.offset,t.field.arrayLength)]),X(e,n)},a=e=>{var n=oa(),r=R(n,!0);M(n),B(e=>Z(r,e),[()=>Vi(new Uint8Array(t.dw.buffer,t.dw.byteOffset+t.offset,t.field.arrayLength))]),X(e,n)};Q(r,e=>{t.field.name.match(/name$/i)?e(i):e(a,!1)}),X(e,n)},u=e=>{var r=fa();sr(r,21,()=>({length:t.field.arrayLength||1}),ar,(e,r,a)=>{var o=da(),s=Dt(o),c=R(s),l=e=>{var n=Qn(),r=Dt(n);sr(r,17,()=>t.field.fields,ar,(e,n)=>{{let r=P(()=>t.offset+(q(n).offset||0)+a*(t.field.size||1));ma(e,{get dw(){return t.dw},get offset(){return q(r)},get field(){return q(n)},get type(){return t.field.type},get repo(){return t.repo}})}}),X(e,n)},u=e=>{var r=Qn(),o=Dt(r),s=e=>{var t=sa(),n=R(t,!0);M(t),B(e=>Z(n,e),[()=>i(a)]),X(e,t)},c=e=>{var r=Qn(),i=Dt(r),o=e=>{var t=ca(),r=R(t,!0);M(t),B(e=>Z(r,e),[()=>n(a)]),X(e,t)},s=e=>{var n=la(),r=R(n);M(n),B(()=>Z(r,`Unsupported field type: ${t.field.type??``}`)),X(e,n)};Q(i,e=>{n(a)===void 0?e(s,!1):e(o)},!0),X(e,r)};Q(o,e=>{i(a)===void 0?e(c,!1):e(s)},!0),X(e,r)};Q(c,e=>{t.field.fields?e(l):e(u,!1)}),M(s);var d=z(s,2),f=e=>{var r=ua(),i=R(r,!0);M(r),B(e=>Z(i,e),[()=>t.repo.getFieldAlias(t.type,t.field.name,n(a),t.subType,t.subValue)]),X(e,r)};Q(d,e=>{t.repo.fieldHasAlias(t.type,t.field.name,t.subType,t.subValue)&&e(f)}),X(e,o)}),M(r),X(e,r)};Q(c,e=>{(t.field.type===`int8`||t.field.type===`uint8`)&&(t.field.arrayLength||0)>1?e(l):e(u,!1)}),M(a),B(()=>Z(s,`${t.field.name??``}:`)),X(e,a),we()}var ha=Y(`<span> </span>`),ga=Y(` <!>`,1),_a=Y(`<span> </span>`),va=Y(`<span> </span>`),ya=Y(`<span>No structure information available for this IPC type.</span>`),ba=Y(`<div class="packet-fields"><div><!></div> <div><!></div></div>`);function xa(e,t){Ce(t,!0);let n=P(()=>t.repo.getOpcodeName(t.packet.opcode,t.packet.dir)),r=P(()=>t.repo.getIpcStruct(q(n)||``)),i=P(()=>new DataView(t.packet.data.buffer,t.packet.data.byteOffset+32,t.packet.data.byteLength-32)),a=P(()=>q(r)&&q(i).byteLength>=q(r).size),o=P(()=>qi(q(r)?.name||``)),s=P(()=>{let e=q(r)?.fields.find(e=>e.name===q(o));if(e)switch(e.type){case`uint8`:return q(i).getUint8(e.offset);case`int8`:return q(i).getInt8(e.offset);case`uint16`:return q(i).getUint16(e.offset,!0);case`int16`:return q(i).getInt16(e.offset,!0);case`uint32`:return q(i).getUint32(e.offset,!0);case`int32`:return q(i).getInt32(e.offset,!0)}});var c=ba(),l=R(c),u=R(l),d=e=>{var t=ga(),a=Dt(t),o=z(a),s=e=>{var t=ha(),n=R(t);M(t),B(()=>Z(n,`(size ${q(i).byteLength??``} != ${q(r)?.size??``})`)),X(e,t)};Q(o,e=>{q(r)&&q(i).byteLength!=q(r)?.size&&e(s)}),B(()=>Z(a,`IPC Type: ${q(n)??``} `)),X(e,t)},f=e=>{var n=_a(),r=R(n);M(n),B(e=>Z(r,`Unknown IPC Type: 0x${e??``}`),[()=>Ri(t.packet.opcode,4)]),X(e,n)};Q(u,e=>{q(n)?e(d):e(f,!1)}),M(l);var p=z(l,2),m=R(p),h=e=>{var n=Qn(),c=Dt(n),l=e=>{var n=Qn(),a=Dt(n);sr(a,17,()=>q(r).fields,ar,(e,n)=>{ma(e,{get dw(){return q(i)},get offset(){return q(n).offset},get field(){return q(n)},get type(){return q(r).name},get subType(){return q(o)},get subValue(){return q(s)},get repo(){return t.repo}})}),X(e,n)},u=e=>{var t=va(),n=R(t);M(t),B(()=>Z(n,`Data length (${q(i).byteLength??``} bytes) is less than expected structure size
          (${q(r).size??``} bytes).`)),X(e,t)};Q(c,e=>{q(a)?e(l):e(u,!1)}),X(e,n)},g=e=>{var t=ya();X(e,t)};Q(m,e=>{q(r)?e(h):e(g,!1)}),M(p),M(c),X(e,c),we()}function Sa(e,t,n,r,i,a,o){let s=t(q(n));if(s!==void 0){for(let e=q(r)-1;e>=0;e--)if(q(i)[e].opcode===s){a(e),o(e);return}}}function Ca(e,t,n,r){switch(e.key){case`ArrowUp`:q(t)>0&&I(t,q(t)-1);break;case`ArrowDown`:q(t)+1<q(n).length&&I(t,q(t)+1);break;default:return}let i=e.target;e.preventDefault(),r(q(t)),i?.parentElement?.focus()}function wa(e,t,n){switch(e.key){case`ArrowLeft`:q(t)>0&&I(t,q(t)-1);break;case`ArrowRight`:q(t)+1<q(n).byteLength&&I(t,q(t)+1);break;case`ArrowUp`:q(t)-16>=0&&I(t,q(t)-16);break;case`ArrowDown`:q(t)+16<q(n).byteLength&&I(t,q(t)+16);break;case`Escape`:I(t,-1);break;default:return}e.preventDefault()}var Ta=(e,t,n)=>t(n()),Ea=Y(`<span class="packet-name svelte-raxl5d"> </span>`),Da=Y(`<button><span class="packet-dir svelte-raxl5d"> </span> <span class="packet-time svelte-raxl5d"> </span> <span class="packet-len svelte-raxl5d"> </span> <span class="packet-opcode svelte-raxl5d"> </span> <span class="packet-data svelte-raxl5d"> </span> <!></button>`),Oa=Y(`<button type="button"> </button>`),ka=Y(`<div class="packet-header svelte-raxl5d"><span class="packet-dir svelte-raxl5d"> </span> <span class="packet-time svelte-raxl5d"> </span> Length: <span class="packet-len svelte-raxl5d"> </span> Opcode: <span class="packet-opcode svelte-raxl5d"> </span></div> <div class="packet-hex svelte-raxl5d" role="grid" tabindex="-1"></div> <div class="packet-info svelte-raxl5d"><!></div>`,1),Aa=Y(`<div class="packet-viewer svelte-raxl5d"><div class="packet-left svelte-raxl5d"><div class="viewer-filter svelte-raxl5d"><span class="label svelte-raxl5d">Count:</span> <span class="value"> </span> <label><span class="label svelte-raxl5d">Opcode:</span> <input type="text" placeholder="enter opcode"/></label> <button type="button" class="svelte-raxl5d">â</button> <button type="button" class="svelte-raxl5d">â</button> <label><span class="label svelte-raxl5d">Filter:</span> <input type="text" placeholder="list separate by comma"/></label> <label><input type="checkbox"/> <span class="label svelte-raxl5d">Self</span></label></div> <div class="packet-list svelte-raxl5d" role="listbox" tabindex="-1"><!></div></div> <div class="packet-detail svelte-raxl5d"><!></div></div>`);function ja(e,t){Ce(t,!0);let n=F([]),r=F(``),i=F(``),a=F(!1);function o(e){let n=parseInt(e);if(n)return n;let r=t.repo.getNameOpcode(e);if(r)return r}function s(){let e=o(q(r));if(e!==void 0){for(let t=q(c)+1;t<q(n).length;t++)if(q(n)[t].opcode===e){d(t),g(t);return}}}let c=F(-1),l=P(()=>q(c)>-1&&q(n).length>q(c)?q(n)[q(c)]:null);function d(e){I(c,e,!0)}let f=P(()=>q(l)?new DataView(q(l).data.buffer,q(l).data.byteOffset,q(l).data.byteLength):new DataView(new ArrayBuffer(0))),p=F(-1);Bt(()=>{q(p)>=q(f).byteLength&&I(p,-1)});function m(e){I(p,e,!0)}let h=null;function g(e){h?.scroll({index:e,smoothScroll:!1,align:`nearest`})}function _(e){e.key===`Enter`&&(s(),e.preventDefault())}let v=``,y=!1;Bt(()=>{q(i),q(a),x()});let b=0;function x(){let e=!1;if(b>t.packets.length&&(e=!0),(q(i)!==v||q(a)!==y)&&(e=!0,v=q(i),y=q(a)),!e&&b===t.packets.length)return;let r=q(i).split(`,`).map(e=>o(e.trim())).filter(e=>e!==void 0);e&&(q(n).length=0,b=0);for(let e=b;e<t.packets.length;e++){let i=t.packets[e];if(q(a)&&i.data.byteLength>=32){let e=!0;for(let t=0;t<4;t++)e&&=i.data.at(4+t)===i.data.at(8+t);if(!e)continue}(r.length===0||r.includes(i.opcode))&&q(n).push(i)}console.log(`Syncing packets, total:`,t.packets.length,`filtered:`,q(n).length,`index:`,b),b=t.packets.length,I(n,[...q(n)])}let S=null;Zr(()=>{S||=setInterval(x,100)});var C=Aa(),ee=R(C),w=R(ee),te=z(R(w),2),T=R(te);M(te);var E=z(te,2),ne=z(R(E),2);Pr(ne),M(E);var re=z(E,2);re.__click=[Sa,o,r,c,n,d,g];var ie=z(re,2);ie.__click=s;var ae=z(ie,2),oe=z(R(ae),2);Pr(oe),M(ae);var se=z(ae,2),ce=R(se);Pr(ce),he(2),M(se),M(w);var le=z(w,2);le.__keydown=[Ca,c,n,g];var D=R(le);qr(Fi(D,{get items(){return q(n)},renderItem:(e,n=u,r=u)=>{var i=Da();i.__click=[Ta,d,r];var a=R(i),o=R(a,!0);M(a);var s=z(a,2),l=R(s,!0);M(s);var f=z(s,2),p=R(f);M(f);var m=z(f,2),h=R(m,!0);M(m);var g=z(m,2),_=R(g,!0);M(g);var v=z(g,2),y=e=>{var r=Ea(),i=R(r,!0);M(r),B(e=>Z(i,e),[()=>t.repo.getOpcodeName(n().opcode,n().dir)]),X(e,r)};Q(v,e=>{t.repo.getOpcodeName(n().opcode,n().dir)&&e(y)}),M(i),B((e,t,a,s)=>{Ir(i,`id`,`packet-`+r()),wr(i,1,vr([`packet-item`,q(c)===r()?`selected`:``]),`svelte-raxl5d`),Z(o,n().dir?`C`:`S`),Z(l,e),Z(p,`${t??``}h`),Z(h,a),Z(_,s)},[()=>Bi(n().epoch),()=>Ri(n().data.length,3),()=>Ri(n().opcode,4),()=>Vi(n().data.slice(32,64))]),X(e,i)},$$slots:{renderItem:!0}}),e=>h=e,()=>h),M(le),M(ee);var O=z(ee,2),ue=R(O),de=e=>{var n=ka(),r=Dt(n),i=R(r),a=R(i,!0);M(i);var o=z(i,2),s=R(o,!0);M(o);var c=z(o,2),u=R(c);M(c);var d=z(c,2),h=R(d,!0);M(d),M(r);var g=z(r,2);g.__keydown=[wa,p,f],sr(g,21,()=>q(l).data,ar,(e,t,n)=>{var r=Oa();r.__click=()=>m(n),Ir(r,`aria-label`,`Inspect byte at `+n);var i=R(r,!0);M(r),B(e=>{wr(r,1,vr([`hex-item`,q(p)===n?`selected`:``]),`svelte-raxl5d`),Z(i,e)},[()=>q(t).toString(16).padStart(2,`0`)]),X(e,r)}),M(g);var _=z(g,2),v=R(_),y=e=>{xa(e,{get packet(){return q(l)},get repo(){return t.repo}})},b=e=>{ia(e,{get dw(){return q(f)},get selectedIndex(){return q(p)}})};Q(v,e=>{q(p)<0?e(y):e(b,!1)}),M(_),B((e,t,n)=>{Z(a,q(l).dir?`Client`:`Server`),Z(s,e),Z(u,`${t??``}h`),Z(h,n)},[()=>new Date(q(l).epoch).toLocaleTimeString(),()=>Ri(q(l).data.length,3),()=>Ri(q(l).opcode,4)]),X(e,n)};Q(ue,e=>{q(l)&&e(de)}),M(O),M(C),B(()=>Z(T,`${q(n).length??``} / ${t.packets.length??``}`)),Gn(`keypress`,ne,_),Hr(ne,()=>q(r),e=>I(r,e)),Hr(oe,()=>q(i),e=>I(i,e)),Ur(ce,()=>q(a),e=>I(a,e)),X(e,C),we()}Kn([`click`,`keydown`]);var Ma=class e{constructor(e=228){this.magicNumber=2712847316,this.versionMajor=2,this.versionMinor=4,this.thisZone=0,this.sigFigs=0,this.snapLen=65535,this.network=e}toArrayBuffer(){let e=new ArrayBuffer(24);return this.setArrayBuffer(e),e}setArrayBuffer(t,n=0){let r=new DataView(t,n);return r.setUint32(0,this.magicNumber,!0),r.setUint16(4,this.versionMajor,!0),r.setUint16(6,this.versionMinor,!0),r.setInt32(8,this.thisZone,!0),r.setUint32(12,this.sigFigs,!0),r.setUint32(16,this.snapLen,!0),r.setUint32(20,this.network,!0),n+e.size()}valid(){return this.magicNumber===2712847316}static size(){return 24}static fromArrayBuffer(t,n=0){let r=new DataView(t,n),i=new e;return i.magicNumber=r.getUint32(0,!0),i.versionMajor=r.getUint16(4,!0),i.versionMinor=r.getUint16(6,!0),i.thisZone=r.getInt32(8,!0),i.sigFigs=r.getUint32(12,!0),i.snapLen=r.getUint32(16,!0),i.network=r.getUint32(20,!0),i}},Na=class e{constructor(e,t){this.tsSec=Math.floor(e/1e3),this.tsUsec=e%1e3*1e3,this.inclLen=t,this.origLen=t}toArrayBuffer(){let e=new ArrayBuffer(16);return this.setArrayBuffer(e),e}setArrayBuffer(t,n=0){let r=new DataView(t,n);return r.setUint32(0,this.tsSec,!0),r.setUint32(4,this.tsUsec,!0),r.setUint32(8,this.inclLen,!0),r.setUint32(12,this.origLen,!0),n+e.size()}epoch(){return this.tsSec*1e3+Math.floor(this.tsUsec/1e3)}static size(){return 16}static fromArrayBuffer(t,n=0){let r=new DataView(t,n),i=new e(0,0);return i.tsSec=r.getUint32(0,!0),i.tsUsec=r.getUint32(4,!0),i.inclLen=r.getUint32(8,!0),i.origLen=r.getUint32(12,!0),i}},Pa=class e{constructor(t,n){this.unk1=0,this.unk2=0,this.unk3=0,this.unk4=0,this.timestamp=n,this.size=t+e.size(),this.cType=1,this.count=1,this.encoding=0,this.compressed=0}toArrayBuffer(){let e=new ArrayBuffer(40);return this.setArrayBuffer(e),e}setArrayBuffer(t,n=0){let r=new DataView(t,n);return r.setUint32(0,this.unk1,!0),r.setUint32(4,this.unk2,!0),r.setUint32(8,this.unk3,!0),r.setUint32(12,this.unk4,!0),r.setBigUint64(16,BigInt(this.timestamp),!0),r.setUint32(24,this.size,!0),r.setUint16(28,this.cType,!0),r.setUint16(30,this.count,!0),r.setInt8(32,this.encoding),r.setInt8(33,this.compressed),n+e.size()}static fromArrayBuffer(t,n=0){let r=new DataView(t,n),i=new e(0,0);return i.unk1=r.getUint32(0,!0),i.unk2=r.getUint32(4,!0),i.unk3=r.getUint32(8,!0),i.unk4=r.getUint32(12,!0),i.timestamp=Number(r.getBigUint64(16,!0)),i.size=r.getUint32(24,!0),i.cType=r.getUint16(28,!0),i.count=r.getUint16(30,!0),i.encoding=r.getInt8(32),i.compressed=r.getInt8(33),i}static size(){return 40}},Fa=class e{constructor(t,n,r,i){this.versionIhl=69,this.totalLength=t+e.size(),this.protocol=n,this.srcAddr=r,this.destAddr=i}toArrayBuffer(){let e=new ArrayBuffer(20);return this.setArrayBuffer(e),e}setArrayBuffer(t,n=0){let r=new DataView(t,n);r.setUint8(0,this.versionIhl),r.setUint16(2,this.totalLength,!1),r.setUint8(8,64),r.setUint8(9,this.protocol),r.setUint32(12,this.srcAddr,!1),r.setUint32(16,this.destAddr,!1);let i=0;for(let e=0;e<20;e+=2)e!==10&&(i+=r.getUint16(e,!1));return i=~i&65535,r.setUint16(10,i,!1),n+e.size()}static size(){return 20}static fromArrayBuffer(t,n=0){let r=new DataView(t,n),i=new e(0,0,0,0);return i.versionIhl=r.getUint8(0),i.totalLength=r.getUint16(2,!1),i.protocol=r.getUint8(9),i.srcAddr=r.getUint32(12,!1),i.destAddr=r.getUint32(16,!1),i}},Ia=class e{constructor(t,n=0,r=0,i=0){this.srcPort=n,this.destPort=r,this.length=t+e.size(),this.checksum=i}toArrayBuffer(){let e=new ArrayBuffer(8);return this.setArrayBuffer(e),e}setArrayBuffer(t,n=0){let r=new DataView(t,n);return r.setUint16(0,this.srcPort,!1),r.setUint16(2,this.destPort,!1),r.setUint16(4,this.length,!1),r.setUint16(6,this.checksum,!1),n+e.size()}static size(){return 8}static fromArrayBuffer(t,n=0){let r=new DataView(t,n),i=new e(0,0,0,0);return i.srcPort=r.getUint16(0,!1),i.destPort=r.getUint16(2,!1),i.length=r.getUint16(4,!1),i.checksum=r.getUint16(6,!1),i}},La=2130706443,Ra=2130706444,za=65300,Ba=65301;function Va(e){let t=Ma.size(),n=Na.size()+Fa.size()+Ia.size()+Pa.size();for(let r of e)t+=n+r.data.byteLength;let r=new ArrayBuffer(t),i=0;i=new Ma().setArrayBuffer(r,i);let a=Pa.size(),o=Ia.size()+a,s=Fa.size()+o;for(let t of e){i=new Na(t.epoch,s+t.data.byteLength).setArrayBuffer(r,i);let e=t.dir?La:Ra,n=t.dir?Ra:La,c=t.dir?za:Ba,l=t.dir?Ba:za;i=new Fa(o+t.data.byteLength,17,e,n).setArrayBuffer(r,i),i=new Ia(a+t.data.byteLength,c,l).setArrayBuffer(r,i),i=new Pa(t.data.byteLength,t.epoch).setArrayBuffer(r,i),t.data.length>=32&&t.data[16]===20&&t.data[12]===0&&(t.data[12]=3),new Uint8Array(r,i,t.data.byteLength).set(t.data),i+=t.data.byteLength}return r}function Ha(e){let t=[],n=0;if(!Ma.fromArrayBuffer(e,n).valid())throw Error(`Invalid PCAP file`);for(n+=Ma.size();n+Na.size()<=e.byteLength;){let r=Na.fromArrayBuffer(e,n);if(n+=Na.size(),n+r.inclLen>e.byteLength)break;let i=Fa.fromArrayBuffer(e,n);n+=Fa.size();let a=Ia.fromArrayBuffer(e,n);n+=Ia.size();let o=Pa.fromArrayBuffer(e,n);n+=Pa.size();let s=new Uint8Array(e,n,o.size-Pa.size());n+=s.byteLength;let c=s.length>=32?s[19]<<8|s[18]:0,l=i.srcAddr===La||a.srcPort===za;t.push({epoch:r.epoch(),dir:l,opcode:c,data:s})}return t}function Ua(e){let t=new DOMParser().parseFromString(new TextDecoder().decode(e),`application/xml`),n=[],r=t.getElementsByTagName(`Capture`)[0];if(!r)throw Error(`Invalid FFXIVMon data: missing <capture> node`);let i=r.getElementsByTagName(`Packets`)[0];if(!i)throw Error(`Invalid FFXIVMon data: missing <packets> node`);let a=i.getElementsByTagName(`PacketEntry`);for(let e=0;e<a.length;e++){let t=a[e],r=t.getElementsByTagName(`Direction`)[0]?.textContent,i=t.getElementsByTagName(`SystemMsTime`)[0]?.textContent,o=t.getElementsByTagName(`Data`)[0]?.textContent||``;if(t.getElementsByTagName(`Connection`)[0]?.textContent!==`Game`)continue;let s=parseInt(i||`0`)-62135625943e3,c=new Uint8Array(o.match(/[\da-fA-F]{2}/g)?.map(e=>parseInt(e,16))||[]);if(c.length<32)continue;let l=c.length>=32?c[19]<<8|c[18]:0;n.push({epoch:s,dir:r===`C`,opcode:l,data:c})}return n}function Wa(e,t,n){t.SubscribePacket(`otk-packet`,[],n)}function Ga(e,t){t.UnsubscribePacket(`otk-packet`)}function Ka(e,t){I(t,[],!0)}function qa(e,t){let n=e.target;if(n.files?.length){let e=n.files[0],r=new FileReader;r.onload=n=>{let r=n.target?.result;if(e.name.endsWith(`.pcap`)){let e=Ha(r);I(t,e.map(e=>({epoch:e.epoch,dir:e.dir,data:e.data,opcode:e.opcode,type:`imported`,name:`imported`,conn:``,length:e.data.length})),!0);return}if(e.name.endsWith(`.xml`)){let e=Ua(r);I(t,e.map(e=>({epoch:e.epoch,dir:e.dir,data:e.data,opcode:e.opcode,type:`imported`,name:`imported`,conn:``,length:e.data.length})),!0);return}},r.readAsArrayBuffer(e)}}var Ja=(e,t)=>t.loadVersion(e.target.value),Ya=Y(`<option> </option>`),Xa=Y(`<main><h1>FFXIV Packet Analyzer</h1> <div><button>Start Capture</button> <button>Stop Capture</button> <button>Clear Packets</button> <button>Export Packets</button> <label for="version-select">Version</label> <select id="version-select"></select> <label for="file">Import</label> <input type="file" id="file" accept=".pcap,.xml" name="pcapFile"/></div> <div class="card"><!></div></main>`);function Za(e,t){Ce(t,!0);let n=new URLSearchParams(location.search),r=new di;r.Start(),r.Connect(n.get(`OVERLAY_WS`)||`ws://localhost:10501/ws`);let i=F(_t([])),a=new Yi;function o(e){q(i).push(e)}function s(){let e=Va(q(i)),t=new Blob([e],{type:`application/vnd.tcpdump.pcap`}),n=URL.createObjectURL(t),r=document.createElement(`a`);r.href=n,r.download=`packets.pcap`,r.click(),URL.revokeObjectURL(n)}a.loadVersions();var c=Xa(),l=z(R(c),2),u=R(l);u.__click=[Wa,r,o];var d=z(u,2);d.__click=[Ga,r];var f=z(d,2);f.__click=[Ka,i];var p=z(f,2);p.__click=s;var m=z(p,4);m.__change=[Ja,a],sr(m,21,()=>a.versionList,ar,(e,t)=>{var n=Ya(),r=R(n,!0);M(n);var i={};B(()=>{Z(r,q(t)),i!==(i=q(t))&&(n.value=(n.__value=q(t))??``)}),X(e,n)}),M(m);var h;Or(m);var g=z(m,4);g.__change=[qa,i],M(l);var _=z(l,2),v=R(_);ja(v,{get packets(){return q(i)},get repo(){return a}}),M(_),M(c),B(()=>{h!==(h=a.version)&&(m.value=(m.__value=a.version)??``,Dr(m,a.version))}),X(e,c),we()}Kn([`click`,`change`]),$n(Za,{target:document.getElementById(`app`)});